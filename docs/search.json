[
  {
    "objectID": "results.html",
    "href": "results.html",
    "title": "Results",
    "section": "",
    "text": "Result 1. CO\nResult 2. CO\nResult 3. CO\nResult 4. CO\nResult 5. CO"
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "Introduction",
    "section": "",
    "text": "Background. COVID-19\nEDA.\nAnalysis."
  },
  {
    "objectID": "intro.html#introduction",
    "href": "intro.html#introduction",
    "title": "Introduction",
    "section": "",
    "text": "Background. COVID-19\nEDA.\nAnalysis."
  },
  {
    "objectID": "data_processing.html",
    "href": "data_processing.html",
    "title": "Data Processing",
    "section": "",
    "text": "Show code\nsuppressPackageStartupMessages(library(data.table))\nsuppressPackageStartupMessages(library(tidyverse))\nsuppressPackageStartupMessages(library(lubridate))\nsuppressPackageStartupMessages(library(scales))\nsuppressPackageStartupMessages(library(purrr))\nsuppressPackageStartupMessages(library(tidycensus))\nsuppressPackageStartupMessages(library(readxl))\nsuppressPackageStartupMessages(library(pdftools))\nsuppressPackageStartupMessages(library(stringr))\n\nsuppressPackageStartupMessages(library(skimr))\nsuppressPackageStartupMessages(library(knitr))\nsuppressPackageStartupMessages(library(kableExtra))\n\nsuppressPackageStartupMessages(library(ggmap))\nsuppressPackageStartupMessages(library(ggplot2))\nsuppressPackageStartupMessages(library(usmap))\nsuppressPackageStartupMessages(library(cowplot))\nsuppressPackageStartupMessages(library(RColorBrewer))"
  },
  {
    "objectID": "data_processing.html#processing-county-level-mortality-county-level-population-and-live-births-country-code-and-country-year-availability",
    "href": "data_processing.html#processing-county-level-mortality-county-level-population-and-live-births-country-code-and-country-year-availability",
    "title": "Data Processing",
    "section": "Processing County-Level Mortality, County-Level Population and Live Births, Country Code, and Country-Year Availability",
    "text": "Processing County-Level Mortality, County-Level Population and Live Births, Country Code, and Country-Year Availability\n\n\nShow code\n# Country code, country-year availability\ndf_country_code &lt;- fread(paste0(idir, \"/\", file_country_code))\n\ndf_country_yr_avability &lt;- read_excel(paste0(idir, \"/\", file_country_yr_availability), \n                                      sheet = \"avail_pop\", skip = 7) %&gt;% \n  select(-any_of(c(\"Admin1\", \"SubDiv\", \"Updates\"))) %&gt;%\n  mutate(avail = 1)\n\n# Population and live births by country\ndf_pop &lt;- fread(paste0(idir, \"/\", file_pop_livebirth)) %&gt;%\n    filter(Year &gt; 2013) %&gt;%\n    select(-c(Admin1, SubDiv, Frmat)) %&gt;%\n    pivot_longer(\n      cols = starts_with(\"Pop\"),\n      names_to = \"Age_group\",\n      values_to = \"Pop_count\"\n    ) \n\n# Mortality\nread_dta &lt;- function(filename) {\n  df &lt;- fread(paste0(idir, \"/\", filename)) %&gt;%\n    filter(Year &gt; 2013) %&gt;%\n    select(-c(Admin1, SubDiv, List, Frmat, IM_Frmat, starts_with(\"IM_Deaths\"))) %&gt;%\n    pivot_longer(\n      cols = starts_with(\"Deaths\"),\n      names_to = \"Age_group\",\n      values_to = \"Death_count\"\n    ) \n  return(df)\n}\n\ndf_raw1 &lt;- read_dta(file_mort1)\ndf_raw2 &lt;- read_dta(file_mort2)\ndf_raw3 &lt;- read_dta(file_mort3)\n\ndf_mortality &lt;- rbind(df_raw1, df_raw2, df_raw3)\nrm(df_raw1, df_raw2, df_raw3)\n\n\nI first checked whether the country-code reference file and the country-year availability data set contained consistent country names and country codes. Unfortunately, there are six countries that lack country-year availability information. To understand whether these countries should still be included in the analysis, I examined whether they have corresponding mortality records in the WHO data set:\n\n\nShow code\ncountries_no_availability &lt;- anti_join(df_country_code %&gt;% \n                                         rename(Country = country) %&gt;% \n                                         distinct(), \n                                       df_country_yr_avability %&gt;% \n                                         select(Country, name) %&gt;% \n                                         distinct(), \n                                       by = c(\"Country\", \"name\")) %&gt;%\n  filter(Country %in% df_mortality$Country) %&gt;%\n  rename(Code = Country, \n         Country = name)\n\ntmp &lt;- list()\nfor (i in seq_len(nrow(countries_no_availability))) {\n  country &lt;- countries_no_availability$Country[i]\n  code    &lt;- countries_no_availability$Code[i]\n  \n  total_deaths &lt;- df_mortality %&gt;%\n    filter(Country == code) %&gt;%\n    pull(Death_count) %&gt;%\n    sum(na.rm = T)\n  tmp[[i]] &lt;- data.frame(Code = code, \n                         Country = country,\n                         Total_Deaths = total_deaths, \n                         stringsAsFactors = FALSE) \n}\nkable(do.call(rbind, tmp), align = c(\"l\", \"l\", \"l\"))\n\n\n\n\n\nCode\nCountry\nTotal_Deaths\n\n\n\n\n1303\nMayotte\n14630\n\n\n2005\nAnguilla\n1972\n\n\n2025\nAruba\n19812\n\n\n3405\nUnited Arab Emirates\n111762\n\n\n4195\nNorth Macedonia\n793160\n\n\n5108\nMicronesia (Federated States of)\n10684\n\n\n\n\n\nShow code\nrm(tmp, code, country, i, total_deaths)\n\n\nSince several countries lacked availability information still had corresponding mortality records, I began by merging the mortality data set with the country-code reference file to attach readable country names to each numeric country code. Next, I merged the mortality data with the country–year availability data set to determine which countries had population and availability information. Any country that appeared in the mortality data set but not in the availability data set was retained in the final merged data frame, with the corresponding availability fields recorded as NA.\n\n\nShow code\ndf &lt;- inner_join(df_mortality, df_country_code, by=c(\"Country\" = \"country\")) \ndf &lt;- left_join(df, df_country_yr_avability, by = c(\"Country\", \"name\", \"Year\")) %&gt;% \n  select(-Country) %&gt;%\n  rename(Country = name) %&gt;%\n  select(Country, everything()) %&gt;%\n  mutate(avail = replace_na(avail, 0))\n\ncount_sex &lt;- table(df$Sex, useNA = \"ifany\")\nkable(t(data.frame(\n  Country = length(unique(df$Country)),\n  Cause_of_Death = length(unique(df$Cause)),\n  Years   = paste(sort(unique(df$Year)), collapse = \", \"),\n  Sex     = paste0(\"male: \",   \n                   100 * round((count_sex[\"1\"]) / nrow(df), 4), \"%, \",\n                   \"female: \", \n                   100 *round((count_sex[\"2\"]) / nrow(df), 4), \"%, \",\n                   \"unknown \", \n                   100 * round((count_sex[\"9\"]) / nrow(df), 4), \"%\"),\n  stringsAsFactors = FALSE\n  )), \n  align = c(\"l\", \"l\"))\n\n\n\n\n\n\n\n\n\nCountry\n134\n\n\nCause_of_Death\n10880\n\n\nYears\n2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023\n\n\nSex\nmale: 52.09%, female: 47.47%, unknown 0.43%\n\n\n\n\n\nShow code\nrm(count_sex, df_country_code, df_country_yr_avability, df_mortality, df_pop, countries_no_availability)\n\n\nI summarized the number of countries, the number of distinct causes of death, the range of years, and the sex distribution in the dataset, and found that it includes 134 countries, 10,880 cause entries, accross ten years of data (2014–2023), and a sex distribution of 52.05% male, 47.47% female, and 0.43% unknown. Among these, the 10,880 entries correspond to detailed list numbers from ICD-10, rather than the standardized 4-digit cause codes typically used for analysis. Because the goal is to classify mortality by the official ICD-10 four-digit codes and their corresponding cause categories, I will need to extract the ICD-10 Mortality Tabulation List to map detailed list numbers into meaningful cause groups.\n\n\n\n\nICD-10 Tabulation List"
  },
  {
    "objectID": "data_processing.html#processing-icd-10-code-mapping",
    "href": "data_processing.html#processing-icd-10-code-mapping",
    "title": "Data Processing",
    "section": "Processing ICD-10 Code Mapping",
    "text": "Processing ICD-10 Code Mapping\nSince the ICD-10 Mortality Tabulation List is not available in a downloadable spreadsheet, I extracted the table located between pages 41–44 of the WHO ICD-10 mortality documentation. Specifically, I included only the content that appears below “Table 8. ICD-10 Mortality Tabulation List 1” and above “Table 9. ICD-10 Detailed Codes (3rd and 4th characters).” Next, I treated any line beginning with a four-digit WHO code as the start of a new record. I then trimmed leading and trailing whitespace, split each line into its component columns, and constructed a clean data frame from the resulting structured text. Within the resulting data frame, I removed the header row (“Code,” “Detailed List of Numbers,” and “Cause”), filtered out lines that were incorrectly captured as page numbers, collapsed multiple spaces into a single space, dropped rows that were broken across lines and manually reconstructed them, and standardized hyphens by replacing ” - ” with “-”. The resulting ICD 10 Mortality Tabulation List looks like:\n\n\nShow code\ntxt &lt;- pdf_text(file.path(idir, file_documentation))[41:44]\n\nlines       &lt;- unlist(strsplit(txt, \"\\n\", fixed = TRUE))\nstart_idx   &lt;- grep(\"^Table 8\\\\. ICD 10 Mortality Tabulation List 1\", lines)\nend_idx     &lt;- grep(\"^Table 9\\\\. ICD 10 detailed codes \\\\(3rd and 4th characters\\\\)\", lines)\ntable_lines &lt;- lines[(start_idx + 1):(end_idx - 1)]\n\nfixed_lines &lt;- character(0)\n\nfor (ln in table_lines) {\n  if (grepl(\"^\\\\s*\\\\d{4}\\\\b\", ln)) {\n    fixed_lines &lt;- c(fixed_lines, ln)\n  } else {\n    if (length(fixed_lines) &gt; 0) {\n      fixed_lines[length(fixed_lines)] &lt;- paste(\n        fixed_lines[length(fixed_lines)],\n        str_squish(ln)\n      )}}}\n\nfixed_lines_trim &lt;- str_trim(fixed_lines)\nsplit_mat &lt;- str_split_fixed(fixed_lines_trim, \"\\\\s{2,}\", n = 3)\n\ndf_icd10 &lt;- data.frame(\n  Code   = split_mat[, 1],\n  Code_range = split_mat[, 2],\n  Cause = split_mat[, 3],\n  stringsAsFactors = F)\n\ndf_icd10 &lt;- df_icd10 %&gt;%\n  mutate(across(\n    everything(),\n    ~ str_replace_all(.x, \"Code\\\\s+Detailed\\\\s+List\\\\s+Numbers\\\\s+Cau.*\", \"\"))) %&gt;%\n  mutate(across(\n    everything(),\n    ~ str_replace(.x, \"Whooping cough\\\\s+39\\\\b\", \"Whooping cough\"))) %&gt;%\n  mutate(across(\n    everything(),\n    ~ str_replace(.x, \"Leukaemia\\\\s+40\\\\b\", \"Leukaemia\"))) %&gt;%\n  mutate(across(\n    everything(),\n    ~ str_replace(.x,\n      \"Diseases of the skin and subcutaneous tissue\\\\s+41\\\\b\",\n      \"Diseases of the skin and subcutaneous tissue\"))) %&gt;%\n  mutate(across(\n    everything(),\n    ~ str_replace(.x,\n        \"^Schistosomiasis\\\\s+.*$\",\n        \"Schistosomiasis\"))) %&gt;%\n  mutate(across(\n    everything(),\n    ~ str_replace_all(.x, \"\\\\s{2,}\", \" \"))) %&gt;%\n  mutate(across(\n    where(is.character),\n    ~ gsub(\" - \", \"-\", .x))) %&gt;%\n  filter(!Code %in% c(\"1025\", \"1046\", \"1103\"))\n\nmanual_1025 &lt;- data.frame(\n  Code = \"1025\",\n  Code_range = \"A21-A32, A38, A42-A49, A65-A79, A81, A83-A89, B00-B04, B06-B09, B25-B49, B58-B64, B66-B94, B99\",\n  Cause = \"Remainder of certain infectious and parasitic diseases\",\n  stringsAsFactors = F)\n\nmanual_1046 &lt;- data.frame(\n  Code = \"1046\",\n  Code_range =\n    \"C17, C23-C24, C26-C31, C37-C41, C44-C49, C51-C52, C57-C60, C62-C66, C68-C69, C73-C81, C88, C96-C97\",\n  Cause = \"Remainder of malignant neoplasms\",\n  stringsAsFactors = F)\n\nmanual_1103 &lt;- data.frame(\n  Code = \"1103\",\n  Code_range = \"W20-W64, W75-W99, X10-X39, X50-X59, Y10-Y89\",\n  Cause = \"All other external causes\",\n  stringsAsFactors = F)\n\ndf_icd10 &lt;- bind_rows(df_icd10, manual_1025, manual_1046, manual_1103) %&gt;%\n  arrange(as.numeric(Code)) %&gt;%\n  mutate(across(everything(), ~ trimws(.)))  # optional cleanup of leading/trailing spaces\n\nkable(head(df_icd10, 10))\n\n\n\n\n\n\n\n\n\n\nCode\nCode_range\nCause\n\n\n\n\n1000\nAll causes\n\n\n\n1001\nA00-B99\nCertain infectious and parasitic diseases\n\n\n1002\nA00\nCholera\n\n\n1003\nA09\nDiarrhoea and gastroenteritis of presumed infectious origin\n\n\n1004\nA01-A08\nOther intestinal infectious diseases\n\n\n1005\nA15-A16\nRespiratory tuberculosis\n\n\n1006\nA17-A19\nOther tuberculosis\n\n\n1007\nA20\nPlague\n\n\n1008\nA33-A35\nTetanus\n\n\n1009\nA36\nDiphtheria\n\n\n\n\n\nNext, I wrote a function to expand ICD code ranges—for example, converting A00–A02, A04–A05 into the full set of codes (A00, A01, A02, A04, A05), and converted the data into a long-format mapping file, with each individual ICD-10 code represented as its own row:\n\n\nShow code\nexpand_icd_range &lt;- function(range) {\n  # Split into start/end codes\n  parts &lt;- strsplit(range, \"-\")[[1]]\n  start &lt;- parts[1]\n  end   &lt;- parts[2]\n  \n  # Extract letter and numbers\n  start_letter &lt;- substr(start, 1, 1)\n  end_letter   &lt;- substr(end,   1, 1)\n  start_num    &lt;- as.integer(substr(start, 2, 3))\n  end_num      &lt;- as.integer(substr(end,   2, 3))\n  \n  letters_seq &lt;- LETTERS[match(start_letter, LETTERS):match(end_letter, LETTERS)]\n  \n  out &lt;- c()\n  for (L in letters_seq) {\n    if (L == start_letter && L == end_letter) {\n      nums &lt;- start_num:end_num\n    } else if (L == start_letter) {\n      nums &lt;- start_num:99\n    } else if (L == end_letter) {\n      nums &lt;- 0:end_num\n    } else {\n      nums &lt;- 0:99\n    }\n    out &lt;- c(out, sprintf(\"%s%02d\", L, nums))\n    }\n  out\n}\n\n\ndf_icd10_long &lt;- df_icd10 %&gt;%\n  mutate(is_range = str_detect(Code_range, \"^[A-Z][0-9]{2}-[A-Z][0-9]{2}$\")) %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    Expanded_codes = list(\n      if (is_range) {\n        expand_icd_range(Code_range)\n      } else {\n        Code_range          # single code or label\n      })) %&gt;%\n  ungroup() %&gt;%\n  unnest(Expanded_codes)\n\nkable(head(df_icd10_long %&gt;% select(Code, Code_range, Cause, Expanded_codes), 5))\n\n\n\n\n\n\n\n\n\n\n\nCode\nCode_range\nCause\nExpanded_codes\n\n\n\n\n1000\nAll causes\n\nAll causes\n\n\n1001\nA00-B99\nCertain infectious and parasitic diseases\nA00\n\n\n1001\nA00-B99\nCertain infectious and parasitic diseases\nA01\n\n\n1001\nA00-B99\nCertain infectious and parasitic diseases\nA02\n\n\n1001\nA00-B99\nCertain infectious and parasitic diseases\nA03\n\n\n\n\n\nHowever, several codes appear more than once, meaning they map to multiple cause categories rather than having a one-to-one relationship:\n\n\nShow code\nsummary_dup &lt;- df_icd10_long %&gt;%\n  filter(Code != \"1000\") %&gt;%  \n  group_by(Expanded_codes) %&gt;% \n  summarize(n = n(),   \n            Codes = paste(unique(Code), collapse=\", \")) %&gt;%\n  filter(n &gt; 1) %&gt;%   \n  arrange(Expanded_codes)\n\nkable(summary_dup %&gt;% head(5))\n\n\n\n\n\nExpanded_codes\nn\nCodes\n\n\n\n\nA00\n2\n1001, 1002\n\n\nA01\n2\n1001, 1004\n\n\nA02\n2\n1001, 1004\n\n\nA03\n2\n1001, 1004\n\n\nA04\n2\n1001, 1004\n\n\n\n\n\nShow code\nprint(paste0(\"Number of duplicated codes: \", nrow(summary_dup)))\n\n\n[1] \"Number of duplicated codes: 810\"\n\n\nI observed that this is because some ICD codes fall under both a detailed category and a broader overarching category. For example, cholera corresponds to the A00 (Code: 1002), but it is also included within the broader range A00–B99 (Code: 1001), which represents “Certain infectious and parasitic diseases.” To preserve this hierarchical structure, I mapped each ICD code to both its detailed code category (e.g., 1002, which corresponds to Cholera) and its broader category (e.g., 1001, which correspond to Certain infectious and parasitic diseases), such that:\n\n\nShow code\ndf_icd10 &lt;- df_icd10_long %&gt;%\n  group_by(Code) %&gt;%\n  mutate(code_count = n_distinct(Expanded_codes)) %&gt;%\n  ungroup() %&gt;%\n  arrange(Expanded_codes, code_count) %&gt;% \n  group_by(Expanded_codes) %&gt;%\n  mutate(rank = row_number()) %&gt;% \n  ungroup() %&gt;%\n  pivot_wider(\n    id_cols   = Expanded_codes,\n    names_from = rank,\n    values_from = c(Code, Code_range, Cause),\n    names_sep = \"_\") %&gt;%\n  rename(\n    Code_detailed       = Code_1,\n    Code_broader        = Code_2,\n    Code_range_detailed = Code_range_1,\n    Code_range_broader  = Code_range_2,\n    Cause_detailed      = Cause_1,\n    Cause_broader       = Cause_2)\n\nexample &lt;- df_icd10 %&gt;%\n  mutate(Expanded_codes = Expanded_codes,\n         Code_range_detailed = paste0(Code_range_detailed, \" (\", \n                                      Code_detailed, \"; \", \n                                      Cause_detailed, \")\"), \n         Code_range_broad = paste0(Code_range_broader, \" (\", \n                                      Code_broader, \"; \", \n                                      Cause_broader, \")\"), ) %&gt;%\n  select(Expanded_codes, Code_range_detailed, Code_range_broad)\n\nkable(head(example, 5)) %&gt;%\n  kable_styling(full_width = FALSE) %&gt;%\n  column_spec(1, width = \"5%\") %&gt;% \n  column_spec(2, width = \"45%\") %&gt;%  \n  column_spec(3, width = \"50%\")\n\n\n\n\n\nExpanded_codes\nCode_range_detailed\nCode_range_broad\n\n\n\n\nA00\nA00 (1002; Cholera)\nA00-B99 (1001; Certain infectious and parasitic diseases)\n\n\nA01\nA01-A08 (1004; Other intestinal infectious diseases)\nA00-B99 (1001; Certain infectious and parasitic diseases)\n\n\nA02\nA01-A08 (1004; Other intestinal infectious diseases)\nA00-B99 (1001; Certain infectious and parasitic diseases)\n\n\nA03\nA01-A08 (1004; Other intestinal infectious diseases)\nA00-B99 (1001; Certain infectious and parasitic diseases)\n\n\nA04\nA01-A08 (1004; Other intestinal infectious diseases)\nA00-B99 (1001; Certain infectious and parasitic diseases)\n\n\n\n\n\nShow code\nrm(manual_1025, manual_1046, manual_1103, split_mat, df_icd10_long, summary_dup, example)"
  },
  {
    "objectID": "data_processing.html#combining-mortality-with-icd-10-code",
    "href": "data_processing.html#combining-mortality-with-icd-10-code",
    "title": "Data Processing",
    "section": "Combining Mortality with ICD-10 Code",
    "text": "Combining Mortality with ICD-10 Code\nTo merge the mortality data set with the ICD mapping table, I first split the mortality data into two subsets: one containing four-digit WHO cause codes (e.g., 1001) and another containing ICD-10 alphanumeric codes (e.g., A00). Each subset was then merged with the corresponding portion of the ICD mapping table using the appropriate key, and the results were combined to create a unified data set.\n\n\nShow code\ndf &lt;- df %&gt;% mutate(cause_is_4digit = str_detect(Cause, \"^[0-9][0-9][0-9][0-9]$\"))\n\ndf_broad_icd &lt;- df %&gt;%\n  filter(cause_is_4digit) %&gt;%\n  left_join(\n    df_icd10 %&gt;%\n      select(-Expanded_codes) %&gt;% \n      distinct(Code_detailed, .keep_all = T),\n    by = c(\"Cause\" = \"Code_detailed\")) %&gt;% \n  mutate(Code_detailed = Cause) %&gt;%\n  select(c(\n  \"Country\", \"Year\", \"Cause\", \"Sex\", \"Age_group\", \"Death_count\", \"avail\", \"cause_is_4digit\", \n  \"Code_detailed\", \"Code_broader\", \"Code_range_detailed\", \"Code_range_broader\",\n  \"Cause_detailed\", \"Cause_broader\"))\n\ndf_detailed_icd &lt;- df %&gt;%\n  filter(!cause_is_4digit) %&gt;%\n  left_join(\n    df_icd10,\n    by = c(\"Cause\" = \"Expanded_codes\")\n  )\n\ndf &lt;- rbind(df_detailed_icd, df_broad_icd) %&gt;%\n  select(-c(cause_is_4digit)) %&gt;% \n  rename(Code = Cause) %&gt;% \n  select(c(Country, Year, Sex, Age_group, Death_count, avail, \n           Code, Cause_detailed, Cause_broader,\n           Code_detailed, Code_range_detailed, \n           Code_broader, Code_range_broader))\n\nkable(head(df, 2))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCountry\nYear\nSex\nAge_group\nDeath_count\navail\nCode\nCause_detailed\nCause_broader\nCode_detailed\nCode_range_detailed\nCode_broader\nCode_range_broader\n\n\n\n\nEgypt\n2014\n1\nDeaths1\n21\n1\nA01\nOther intestinal infectious diseases\nCertain infectious and parasitic diseases\n1004\nA01-A08\n1001\nA00-B99\n\n\nEgypt\n2014\n1\nDeaths2\n5\n1\nA01\nOther intestinal infectious diseases\nCertain infectious and parasitic diseases\n1004\nA01-A08\n1001\nA00-B99\n\n\n\n\n\nShow code\nrm(df_broad_icd, df_detailed_icd, df_icd10)\n\n\nAfter incorporating the ICD-10 tabulation list, the data set now contains 106 detailed causes of death and 13 broad cause categories:\n\n\nShow code\ncount_sex &lt;- table(df$Sex, useNA = \"ifany\")\nkable(t(data.frame(\n  Country = length(unique(df$Country)),\n  Detailed_Cause_of_Death = length(unique(df$Cause_detailed)),\n  Broad_Cause_of_Death = length(unique(df$Cause_broader)),\n  Years   = paste(sort(unique(df$Year)), collapse = \", \"),\n  Sex     = paste0(\"male: \",   \n                   100 * round((count_sex[\"1\"]) / nrow(df), 4), \"%, \",\n                   \"female: \", \n                   100 *round((count_sex[\"2\"]) / nrow(df), 4), \"%, \",\n                   \"unknown \", \n                   100 * round((count_sex[\"9\"]) / nrow(df), 4), \"%\"),\n  stringsAsFactors = FALSE)), \n  align = c(\"l\", \"l\"))\n\n\n\n\n\n\n\n\n\nCountry\n134\n\n\nDetailed_Cause_of_Death\n107\n\n\nBroad_Cause_of_Death\n13\n\n\nYears\n2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023\n\n\nSex\nmale: 52.09%, female: 47.47%, unknown 0.43%\n\n\n\n\n\nShow code\nrm(count_sex)"
  },
  {
    "objectID": "midterm.html",
    "href": "midterm.html",
    "title": "Analysis of the United States",
    "section": "",
    "text": "Show code\nsuppressPackageStartupMessages(library(data.table))\nsuppressPackageStartupMessages(library(tidyverse))\nsuppressPackageStartupMessages(library(lubridate))\nsuppressPackageStartupMessages(library(scales))\nsuppressPackageStartupMessages(library(purrr))\nsuppressPackageStartupMessages(library(tidycensus))\n\nsuppressPackageStartupMessages(library(skimr))\nsuppressPackageStartupMessages(library(knitr))\nsuppressPackageStartupMessages(library(kableExtra))\n\nsuppressPackageStartupMessages(library(ggmap))\nsuppressPackageStartupMessages(library(ggplot2))\nsuppressPackageStartupMessages(library(usmap))\nsuppressPackageStartupMessages(library(cowplot))\nsuppressPackageStartupMessages(library(RColorBrewer))\n\n\n\n\nBackground. COVID-19 pandemic took millions of lives and has profound impact on global health. It also influenced mortality from other diseases through comorbidity, disruptions in health care access, and changes in life styles. In this analysis, I compare geotemporal mortlity patterns in the United States before (2014-2019) and during (2020-2023) COVID-19 pandemic to understand how overall and cause-specific death changed across time and region.\nEDA. The primary object of the exploratory data analysis is to check:\n\nDo we have death count for each year and each week?\nWhat is the distribution of weekly death count for each disease and each year? How do those distribution differ before and during COVID-19?\nWhat is the yearly death count / precentage (using Census estimates) for each State?\n\nAnalysis. The primary object of this project is to evaluate:\n\nWhen dividing data to pre COVID-19 (2014 - 2019) and during COVID-19 (2020 - 2023) periods, what’s the percent change in mean weekly death count for each disease?\nIs there temporal patterns for disease-specific death counts between 2014 - 2023? How do these patterns align with COVID-19 death pattern? Which month has the lowest/highest of weekly death? How do monthly death counts vary across each year?\nWhich State has the highest disease-specific death (weighted by census estimation of population)? Is there any region disproportionately affected?\n\n\n\n\nWeekly count of death by state and select causes in 2014-2019 vs 2020-2023 were exported from CDC. US Census Estimates were pulled from usmap package.\nThe data sets for 2020-2023 includes additional columns, COVID-19 (U071, Multiple Cause of Death) and COVID-19 (U071, Underlying Cause of Death), due to COVID19 pandemic. Additionally, deaths caused by influenza and pneumonia category changed from J10-J18 (2014-2019) to J09-J18 (2020-2023).\nHere, I converted count of death columns in both data sets from chr to numeric and Week Ending Date column in 2014-2019 data set from chr to IDate. Next, I manually added columns that were missing in either data set (i.e., present in one data set but not the other) and set their values to NA. Then, I create a new column named Dataset Type to distinguish data from 2015-2019 and 2020-2023. Finally, I combined two data sets into one. Additionally, I created a new variable named Influenza and pneumonia that combines Influenza and pneumonia (J10-J18) from 2014-2019 and Influenza and pneumonia (J09-J18) from 2020-2023.\n\n\nShow code\nidir      &lt;- \"/Users/xinranwang/Documents/Course/25Fall/PM566/Data\"\nfilename1 &lt;- \"Weekly_Counts_of_Deaths_by_State_and_Select_Causes,_2014-2019_20251015.csv\"\nfilename2 &lt;- \"Weekly_Provisional_Counts_of_Deaths_by_State_and_Select_Causes,_2020-2023_20251015.csv\"\n\n\n\n\nShow code\ndf_2014_2019 &lt;- fread(paste0(idir, \"/\", filename1))\ndf_2020_2023 &lt;- fread(paste0(idir, \"/\", filename2))\n\n# setequal(names(df_2014_2019), names(df_2020_2023))  # Check if colnames are same: No\n# setdiff(names(df_2014_2019), names(df_2020_2023))   # Columns in 2014-19 but not 2020-23\n# setdiff(names(df_2020_2023), names(df_2014_2019))   # Columns in 2020-23 but not 2014-19\n\ndf_2014_2019 &lt;- df_2014_2019 %&gt;% \n  mutate(across(5:17, ~ as.numeric(gsub(\",\", \"\", .x))),\n         `Dataset Type`                               = \"2014-2019\", \n         `Influenza and pneumonia (J09-J18)`          = NA,\n         `Data As Of`                                 = NA, \n         `COVID-19 (U071, Multiple Cause of Death)`   = NA, \n         `COVID-19 (U071, Underlying Cause of Death)` = NA, \n         `flag_cov19mcod`                             = NA, \n         `flag_cov19ucod`                             = NA,\n         `Week Ending Date` = as.IDate(`Week Ending Date`, format = \"%m/%d/%Y\")) %&gt;%\n  rename(`All Cause` = `All  Cause`) \n\ndf_2020_2023 &lt;- df_2020_2023 %&gt;% \n  mutate(across(6:20, ~ as.numeric(gsub(\",\", \"\", .x))),\n         `Dataset Type`                               = \"2020-2023\", \n         `Influenza and pneumonia (J10-J18)`          = NA)\n\n# setequal(names(df_2014_2019), names(df_2020_2023))  # Check if colnames are same: Yes\n\ndf &lt;- bind_rows(df_2014_2019, df_2020_2023)\n\ndf &lt;- df %&gt;%\n    mutate(`Influenza and pneumonia` = \n             coalesce(`Influenza and pneumonia (J09-J18)`,\n                      `Influenza and pneumonia (J10-J18)`),\n           `COVID` = rowSums(across(c(\n             `COVID-19 (U071, Multiple Cause of Death)`, \n             `COVID-19 (U071, Underlying Cause of Death)`))))\n\nrm(df_2014_2019, df_2020_2023, filename1, filename2)\n\ndisease_order &lt;- c(\n  \"All Cause\",\n  \"Natural Cause\",\n  \"Unclassified symptoms, signs and abnormal findings\",\n  \"Septicemia\",\n  \"Nephritis, nephrotic syndrome and nephrosis\",\n  \"Diabetes mellitus\",\n  \"Alzheimer disease\",\n  \"Cerebrovascular diseases\",\n  \"Malignant neoplasms\",\n  \"Diseases of heart\",\n  \"Other diseases of respiratory system\",\n  \"Influenza and pneumonia\",\n  \"Chronic lower respiratory diseases\",\n  \"COVID-19 (Multiple Cause of Death)\",\n  \"COVID-19 (Underlying Cause of Death)\",\n  \"COVID\"\n  )\n\nyears_palette &lt;- viridisLite::plasma(10)\nyears &lt;- 2014:2023\nnames(years_palette) &lt;- years\n\ndf &lt;- df %&gt;% \n  rename(\n    Septicemia                 = `Septicemia (A40-A41)`,\n    `Malignant neoplasms`      = `Malignant neoplasms (C00-C97)`,\n    `Alzheimer disease`        = `Alzheimer disease (G30)`,\n    `Diabetes mellitus`        = `Diabetes mellitus (E10-E14)`,\n    `Diseases of heart`        = `Diseases of heart (I00-I09,I11,I13,I20-I51)`,\n    `Cerebrovascular diseases` = `Cerebrovascular diseases (I60-I69)`,\n    `Nephritis, nephrotic syndrome and nephrosis` = \n      `Nephritis, nephrotic syndrome and nephrosis (N00-N07,N17-N19,N25-N27)`,\n    `Unclassified symptoms, signs and abnormal findings` = \n      `Symptoms, signs and abnormal clinical and laboratory findings, not elsewhere classified (R00-R99)`,\n    `Chronic lower respiratory diseases` = \n      `Chronic lower respiratory diseases (J40-J47)`,\n    `Other diseases of respiratory system` = \n      `Other diseases of respiratory system (J00-J06,J30-J39,J67,J70-J98)`,\n    `COVID-19 (Multiple Cause of Death)`   = `COVID-19 (U071, Multiple Cause of Death)`,\n    `COVID-19 (Underlying Cause of Death)` = `COVID-19 (U071, Underlying Cause of Death)`\n  ) %&gt;%\n  select(c(\"Jurisdiction of Occurrence\",\n           \"MMWR Year\",\n           \"MMWR Week\",\n           \"Week Ending Date\"),\n         any_of(disease_order), everything())\n\n\n\n\n\n\n\nAfter combining and cleaning dataset from 2014-2019 and 2020-2023, the final data set contains 27,378 rows and 38 columns. The data include location information (USA and individual states), temporal patterns (year and week start date), weekly death count by various disease, and indicator flags for relevant diseases.\nDeath counts are categorized as total (all-cause), natural cause, and 12 specific diseases. COVID-19 is further divided into multiple cause and underlying cause of deaths.\n\n\nShow code\n# Skim everything except IDate column:\nskim(df %&gt;% select(-`Week Ending Date`))\n\n# For IDate formatted column:\nprint(paste0(\"Number of rows of Week Ending Date: \", length(df$`Week Ending Date`)))\nprint(paste0(\"Completeness: \", \n             length(!is.na(df$`Week Ending Date`)) / length(df$`Week Ending Date`)))\nstr(df$`Week Ending Date`)\nsummary(df$`Week Ending Date`)\n\n# Head and Tail\nhead(df, 5)\ntail(df, 5)\n\n\n\n\n\nI began by checking number of weeks reported per year. All COVID-19 related categories shared the same number of weeks, as did all non-COVID diseases (although the the two groups differs from each other). Thus, I summarized the data by collapsing them into 2 rows: number of weeks for COVID and for non-COVID diseases.\n\n\nShow code\ndf_count_week &lt;- df %&gt;%\n  filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n  rename(Year = `MMWR Year`, Week = `MMWR Week`) %&gt;%\n  transmute(\n    Year, Week,\n    across(all_of(disease_order), ~ as.numeric(gsub(\",\", \"\", .x)))\n  ) %&gt;%\n  arrange(Year, Week) %&gt;%\n  group_by(Year) %&gt;%\n  summarise(across(all_of(disease_order), ~ sum(!is.na(.x)))) %&gt;%\n  ungroup() %&gt;%\n  pivot_longer(-Year, names_to = \"Disease\", values_to = \"Weeks\") %&gt;%\n  pivot_wider(names_from = Year, values_from = Weeks)\n\ndf_count_week_collapsed &lt;- df_count_week %&gt;%\n  group_by(across(-Disease)) %&gt;%   \n  summarise(Diseases = paste(Disease, collapse = \", \")) %&gt;%\n  ungroup() %&gt;%\n  select(Diseases, everything())\n\nkable(df_count_week_collapsed,\n      align = c(\"l\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\"),\n      caption = \"Table 1. Number of Weeks Recorded in United States per Year\") %&gt;%\n  kable_styling(full_width = FALSE) %&gt;%\n  column_spec(1, width = \"10cm\") \n\nrm(df_count_week, df_count_week_collapsed)\n\n\n\n\n\nThen, I plotted the distribution of weekly death count for each disease from 2014 to 2023. Most diseases show a clear rightward shift from pre COVID-19 period to during COVID-19 period, except influenza and phenomena and chronic lower respiratory disease, which is likely due to public health measures implemented during COVID (such as mask wearing, physical distancing, etc). There is a significant decrease in weekly death count for COVID in 2023 (as compared to 2020 - 2022), likely due to reduced reporting (See Table 2).\n\n\nShow code\nplot_disease_distribution &lt;- function(disease_col, bins = 30, show_legend = FALSE) {\n  if (grepl(\"COVID\", disease_col, ignore.case = TRUE)) {\n    dat &lt;- df %&gt;% filter(`MMWR Year` &gt;= 2020)\n  } else {\n    dat &lt;- df\n  }\n  \n  dat &lt;- dat %&gt;%\n    rename(Year = `MMWR Year`) %&gt;%\n    filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n    transmute(\n      Year = factor(Year),  \n      Count = as.numeric(gsub(\",\", \"\", .data[[disease_col]]))\n    )\n\n  ggplot(dat, aes(x = Count, fill = Year)) +\n    geom_histogram(bins = bins, color = \"white\", alpha = 0.7, position = \"identity\") + \n    labs(title = disease_col, x = \"Weekly Death Count\", y = \"Count\") +\n    scale_x_continuous(labels = scales::comma) +\n    scale_fill_manual(values = years_palette, drop = T) +\n    theme_minimal(base_size = 8) +\n    theme(\n      plot.title  = element_text(size = 8, face = \"bold\"),\n      axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n      axis.text.y = element_text(size = 8),\n      legend.position = if (show_legend) \"bottom\" else \"none\"\n    )\n}\n\nplot_list &lt;- lapply(disease_order, plot_disease_distribution, bins = 30)\nmain_plot &lt;- plot_grid(\n  plotlist = plot_list,\n  ncol=4\n  )\n\nplot_for_legend &lt;- plot_disease_distribution(disease_order[1], 30, show_legend = T) +\n  ggplot2::theme(legend.position = \"bottom\")\nlegend &lt;- cowplot::ggdraw(get_plot_component(plot_for_legend, 'guide-box-bottom', return_all = TRUE))\n\nplot_grid(\n  plotlist = c(main_plot, legend),\n  ncol=1,\n  label_size = 8,                           \n  label_fontface = \"bold\", \n  rel_heights = c(1, 0.1)\n)\n\nrm(plot_disease_distribution, plot_list, main_plot, plot_for_legend, legend)\n\n\n\n\n\nAdditionally, I evaluated COVID-19 death count by State for all diseases. West Virginia, Alabama, Arizona, Mississippi, Tennessee were among the most severely affected States in 2021, each reporting COVID-19 mortality exceeding 0.37% of their population.\n\n\nShow code\ndf_year &lt;- df %&gt;%\n  filter(`Jurisdiction of Occurrence` != \"United States\") %&gt;%\n  rename(\n    State = `Jurisdiction of Occurrence`,\n    Year  = `MMWR Year`,\n    Week  = `MMWR Week`\n  ) %&gt;%\n  transmute(\n    State,\n    Year,\n    across(all_of(disease_order), ~ as.numeric(gsub(\",\", \"\", .x)))\n  ) %&gt;%\n  group_by(State, Year) %&gt;%\n  summarise(across(all_of(disease_order), sum, na.rm = TRUE)) %&gt;%\n  ungroup %&gt;%\n  pivot_longer(all_of(disease_order), \n               names_to = \"Disease\", \n               values_to = \"Count\") %&gt;%\n  pivot_wider(\n    names_from  = c(Disease, Year),\n    values_from = Count,\n    names_sep   = \" \"\n  ) %&gt;%\n  arrange(State)\n\n#\ndf_pop &lt;- map_dfr(\n  2020:2023,\n  ~ get_estimates(geography = \"state\", product = \"population\", year = .x) %&gt;%\n    filter(variable == \"POPESTIMATE\") %&gt;%\n    transmute(State = NAME, Year = .x, Population = value)\n  )\n  \ndf_pop &lt;- df_pop %&gt;%\n  tidyr::pivot_wider(names_from = Year, values_from = Population,\n                     names_prefix = \"Population \")\n\nkable(left_join(\n  df_year %&gt;% \n    select(State, matches(\"COVID 202\")) %&gt;%\n    rename_with(~ gsub(\"COVID \", \"\", .x)), \n  df_pop, \n  by = \"State\") %&gt;%\n    mutate(\n      `2020 Count (%)` = paste0(format(`2020`, big.mark=\",\"), \" (\", \n                      format(round((`2020` / `Population 2020`) * 100, 2), \n                             big.mark=\",\"), \"%)\"), \n      `2021 Count (%)` = paste0(format(`2021`, big.mark=\",\"), \" (\", \n                      format(round((`2021` / `Population 2021`) * 100, 2), \n                             big.mark=\",\"), \"%)\"),\n      `2022 Count (%)` = paste0(format(`2022`, big.mark=\",\"), \" (\", \n                      format(round((`2022` / `Population 2022`) * 100, 2), \n                             big.mark=\",\"), \"%)\"), \n      `2023 Count (%)` = paste0(format(`2023`, big.mark=\",\"), \" (\", \n                      format(round((`2023` / `Population 2023`) * 100, 2), \n                             big.mark=\",\"), \"%)\")) %&gt;%\n    select(c(State, `2020 Count (%)`, `2021 Count (%)`, `2022 Count (%)`, `2023 Count (%)`)),\n  align = c(\"l\", \"c\", \"c\", \"c\"), \n  caption = \"Table 2. COVID Death by State (2020-2023)\")\n\n\n\n\n\n\n\n\nFirst, I evaluate the trend of weekly all cause mortality from 2014 to 2023 in the United States. Overall, summer months (June - August) tends to have fewest death, whereas winter (December - January) tends to have the highest number of deaths. December 2020 - January 2021 were the peak periods of COVID-19 impact, with weekly deaths reaching 87,033 in December and 87,415 in January.\n\n\nShow code\nkable(df %&gt;%\n        filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n        mutate(Month = month(as.Date(`Week Ending Date`) - 3, label = TRUE, abbr = TRUE)) %&gt;%\n        rename(Year = `MMWR Year`) %&gt;%\n        group_by(Year) %&gt;%\n        summarize(\n          `Min (Mo.)` = paste0(format(round(min(`All Cause`, na.rm = TRUE), 0), \n                                      big.mark=\",\"), \n                               \" (\", Month[which.min(`All Cause`)], \".)\"),\n          `1st quartile` = format(round(quantile(`All Cause`, 0.25, na.rm = TRUE),0), \n                                  big.mark=\",\"),\n          `Median`       = format(round(quantile(`All Cause`, 0.5,  na.rm = TRUE), 0), \n                                  big.mark=\",\"),\n          `Mean`         = format(round(mean(`All Cause`, na.rm = TRUE),0), big.mark=\",\"),\n          `3rd quartile` = format(round(quantile(`All Cause`, 0.75, na.rm = TRUE),0), \n                                  big.mark=\",\"),\n          `Max (Mo.)`    = paste0(format(round(max(`All Cause`, na.rm = TRUE), 0), \n                                         big.mark=\",\"),\n                                  \" (\", Month[which.max(`All Cause`)], \".)\"),\n          `Mean (SD)`    = paste0(Mean, \" (\", round(sd(`All Cause`,na.rm = TRUE), 0), \")\")) %&gt;%\n        select(Year, `Min (Mo.)`, `1st quartile`, `Mean (SD)`, everything()),\n  caption = \"Table 3. Summary Statistics of Weekly All Cause Death (2014-2023) in United States\",\n  align = \"c\")\n\n\n\n\n\nHere, I accessed mean weekly death for each disease before (2014-2019) and during (2020-2023) COVID-19 pandemic in the United States. The corresponding percentage change was also calculated.\nBoth all causes of death and nature cause of death increased approximately 19%. Most diseases showed an overall percentage increase (greater than population growth rate of 0.52%) in deaths. Specifically, there was substantial increase in mortality from unclassified symptoms, signs and abnormal findings, diabetes mellitus, other diseases of respiratory system, cerebrovascular diseases (36.58%, 22.29%, 15.7%, 13.09% increase, respectively). Mortality due Influenza and chronic lower respiratory disease decreased by 14.58% and 5.7%, likely due to death being re-classified as COVID-19 related deaths (either as multiple or underlying causes).\n\n\nShow code\nkable(df %&gt;%\n        dplyr::filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n        group_by(`Dataset Type`) %&gt;%\n        summarise(\n          across(all_of(disease_order), \n                 ~ round(mean(as.numeric(.x), na.rm = TRUE),2), \n                 .names = \"{col}\")) %&gt;%\n        ungroup() %&gt;%\n        pivot_longer(-`Dataset Type`, \n                     names_to = \"Variable\", \n                     values_to = \"Mean\") %&gt;%\n        pivot_wider(names_from = `Dataset Type`, \n                    values_from = Mean) %&gt;%\n        mutate(`% Change` = \n                 paste0(\n                   round(((`2020-2023` - `2014-2019`) / `2014-2019`) * 100, 2), \"%\"),\n               `2014-2019` = format(round(`2014-2019`, 0), big.mark = \",\"),\n               `2020-2023` = format(round(`2020-2023`, 0), big.mark = \",\")),\n      caption = \"Table 4. Summary Statistics of Mean Weekly Mortality (Before vs During COVID-19) in United States\",\n      align = c(\"l\", \"c\", \"c\", \"c\")) %&gt;%\n  kable_styling(full_width = FALSE) %&gt;%\n  column_spec(1, width = \"10cm\")\n\n\n\n\n\nNext, I examined mean weekly death for each disease per year in the United States. Note that mean weekly death were used instead of annual death count because only 37 weeks was recorded in 2023.\nI observed similar trends all-cause and natural-cause mortality, as well as death due to nephritis, nephrotic syndrome and nephrosis, diabetes mellitus, cerebrovascular diseases, malignant neoplass, diseases of the heart. Mortality showed slightly upward trend during pre COVID-19 years (2014-2019), followed by a sharp increase from 2019-2020. The upward trend continued at a slower rate between 2020-2021 and declined from 2021-2023. However, mortality levels remained higher than those in 2019, consistent with the pre COVID-19 increasing trend.\nThere is similar pattern for other disease with respiratory system, except that mortality did not decline after 2021. Septicemia exhibited a sharp decline in 2019, followed by a steady rise from 2020-2022, peaking in 2022, which aligns with the context of COVID-19 as Septicemia can result from an excessive immune response. Mortality due to Alzheimer’s disease showed a substantial increase in 2020. Deaths due to influenza and pneumonia and chronic lower respiratory diseases declined, likely due to public health measures. Deaths attributable to unclassified symptoms, signs and abnormal findings rose sharply in 2023.\nPatterns by year\n\n\nShow code\n################## Average Weekly Death per Year\nplot_disease_yearly &lt;- function(disease_col, line_col = \"steelblue\") {\n  \n  dat &lt;- df %&gt;%\n    filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n    transmute(\n      `MMWR Year`,\n      `Week Ending Date`,\n      Count = as.numeric(gsub(\",\", \"\", .data[[disease_col]])) \n    ) %&gt;%\n    group_by(`MMWR Year`) %&gt;%\n    summarise(\n      Mean  = mean(Count, na.rm = TRUE),\n      SD    = sd(Count,   na.rm = TRUE),\n      SE    = SD / sqrt(sum(!is.na(Count)))\n    ) %&gt;%\n    ungroup() %&gt;%\n    rename(Year = `MMWR Year`)\n    \n  ggplot(dat, aes(x = Year, y = Mean)) +\n    geom_line(linewidth = 1, color = line_col) +\n    geom_point(size = 2, color = line_col) +\n    geom_errorbar(aes(ymin = Mean - SE, ymax = Mean + SE),\n                  width = 0.2, color = line_col) +\n    labs(\n      title = disease_col,\n      x = \"Year\",\n      y = \"Avg Weekly Death Count\"\n    ) +\n    scale_x_continuous(breaks = 2014:2023, limits = c(2014, 2023)) +\n    theme_minimal(base_size = 8) +\n    theme(plot.title  = element_text(size = 8, face = \"bold\"),\n          axis.text.x = element_text(hjust = 1, angle = 45)) \n}\n\nplots_list &lt;- map(disease_order, plot_disease_yearly)\n\nplot_grid(\n  plotlist = plots_list,\n  ncol = 4,\n  align = \"hv\",\n  labels = paste0(LETTERS[seq_along(plots_list)], \".\"),\n  label_x = 0, hjust = 0, label_size = 8\n)\n\nrm(plot_disease_yearly, plots_list)\n\n\nPatterns by Month and Year\nSince Table 3 shows that the minimum weekly death count typically occur during summer and the maximized during winter, I further examined seasonal pattern by plotting monthly death counts by month and year.\nThe results showed U-shaped trend in monthly deaths, with lowest in summer and highest in winter, for all death count categories except malignant neoplasms. Additionally, the death count for 2020-2023 is generally higher than than those for 2014-2019, consistent with the findings in Table 4.\n\n\nShow code\n################## Average Monthly Death per Year\nplot_disease_monthly &lt;- function(disease_col, show_legend = FALSE, year_start, year_end) {\n  \n  dat &lt;- df %&gt;%\n    filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n    transmute(\n      `MMWR Year`,\n      `Week Ending Date`,\n      Month = month(as.Date(`Week Ending Date`)),\n      Year = as.character( `MMWR Year`),\n      #Weekly_Count = as.numeric(gsub(\",\", \"\", `All Cause`))\n      Weekly_Count = as.numeric(gsub(\",\", \"\", .data[[disease_col]]))\n    ) %&gt;%\n    group_by(Year, Month) %&gt;%\n    summarize(Monthly_Count = sum(Weekly_Count, na.rm=T)) %&gt;%\n    ungroup()\n  \n  ymax &lt;- max(dat$Monthly_Count, na.rm=T)\n  ymin &lt;- min(dat$Monthly_Count, na.rm=T) \n  \n  ymax_2014_2019 &lt;- (dat %&gt;%\n    filter(Year &gt;= 2014, Year &lt;= 2019) %&gt;%\n    summarise(ymax = max(Monthly_Count, na.rm = TRUE)))$ymax\n  ymin_2014_2019 &lt;- (dat %&gt;%\n    filter(Year &gt;= 2014, Year &lt;= 2019) %&gt;%\n    summarise(ymin = min(Monthly_Count, na.rm = TRUE)))$ymin\n  \n  dat &lt;- dat %&gt;% filter(Year &gt;= year_start & Year &lt;= year_end) \n    \n  ggplot(dat, aes(x = Month, y = Monthly_Count, color = Year, group = Year)) +\n    geom_hline(yintercept = ymax_2014_2019, linewidth = 0.5, color = \"grey\") +\n    geom_hline(yintercept = ymin_2014_2019, linewidth = 0.5, color = \"grey\") +\n    annotate(\"rect\", xmin = -Inf, xmax = Inf, ymin = ymin_2014_2019, ymax = ymax_2014_2019,\n           alpha = 0.2, fill = \"lightgrey\") +\n    geom_line(linewidth = 0.5, alpha = 0.7) +\n    geom_point(size = 1) +\n    labs(\n      title = disease_col,\n      subtitle = paste0(year_start, \"-\", year_end),\n      x = \"Month\",\n      y = \"Monthly Death Count\"\n    ) +\n    scale_color_manual(values = years_palette, drop = T) +\n    scale_x_continuous(breaks = 1:12, limits = c(1, 12)) +\n    scale_y_continuous(labels = comma, limits = c(ymin, ymax)) +\n    theme_minimal(base_size = 8) +\n    theme(\n      plot.title  = element_text(size = 8, face = \"bold\"),\n      axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n      axis.text.y = element_text(size = 8),\n      legend.position = if (show_legend) \"bottom\" else \"none\"\n    )\n}\n\n#\nplots_list_2014_2019_1 &lt;- map(disease_order[1:8], ~ plot_disease_monthly(.x, FALSE, 2014, 2019))\nmain_plot_2014_2019_1 &lt;- plot_grid(\n  plotlist = plots_list_2014_2019_1,\n  ncol = 1,\n  align = \"hv\",\n  labels = c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\"),\n  label_x = 0, hjust = 0, label_size = 8\n)\n\nplots_list_2014_2019_2 &lt;- map(disease_order[9:16], ~ plot_disease_monthly(.x, FALSE, 2014, 2019))\nmain_plot_2014_2019_2 &lt;- plot_grid(\n  plotlist = plots_list_2014_2019_2,\n  ncol = 1,\n  align = \"hv\",\n  labels = c(\"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\"),\n  label_x = 0, hjust = 0, label_size = 8\n)\n\n#\nplots_list_2020_2023_1 &lt;- map(disease_order[1:8], ~ plot_disease_monthly(.x, FALSE, 2020, 2023))\nmain_plot_2020_2023_1 &lt;- plot_grid(\n  plotlist = plots_list_2020_2023_1,\n  ncol = 1,\n  align = \"hv\",\n  label_x = 0, hjust = 0, label_size = 8\n)\n\nplots_list_2020_2023_2 &lt;- map(disease_order[9:16], ~ plot_disease_monthly(.x, FALSE, 2020, 2023))\nmain_plot_2020_2023_2 &lt;- plot_grid(\n  plotlist = plots_list_2020_2023_2,\n  ncol = 1,\n  align = \"hv\",\n  label_x = 0, hjust = 0, label_size = 8\n)\n\n#\nplot_for_legend &lt;- plot_disease_monthly(disease_order[1], TRUE, 2014, 2023) +\n  ggplot2::theme(legend.position = \"bottom\")\nlegend &lt;- cowplot::ggdraw(get_plot_component(plot_for_legend, 'guide-box-bottom', return_all = TRUE))\n\n#\nmerged_plot &lt;- plot_grid(\n  plotlist = c(main_plot_2014_2019_1, main_plot_2020_2023_1, \n               main_plot_2014_2019_2, main_plot_2020_2023_2),\n  ncol=4,\n  label_size = 8,                           \n  label_fontface = \"bold\"\n)\n\n#\nplot_grid(\n  plotlist = c(merged_plot, legend),\n  ncol=1,\n  label_size = 8,                           \n  label_fontface = \"bold\", \n  rel_heights = c(1, 0.1)\n)\n\nrm(plot_disease_monthly, dat,\n   ymin, ymax, ymin_2014_2019, ymax_2014_2019,\n   plots_list_2014_2019_1, plots_list_2014_2019_2, \n   main_plot_2014_2019_1, main_plot_2014_2019_2,\n   plots_list_2020_2023_1, plots_list_2020_2023_2,\n   main_plot_2020_2023_1, main_plot_2020_2023_2,\n   plot_for_legend, merged_plot)\n\n\n\n\n\nHere, I evaluated mortality by disease and by week of the year in the United States. Weekly mortality counts was divided by five categories: (1) mortality of nature cause or all causes, (2) mortality attributable to respiratory diseases, (3) mortality attributable to COVID-19, (4) mortality attributable to other diseases with lower mortality counts, and (5) mortality attributable to other diseases with higher mortality counts. The categorization was applied as mortality differ across various causes of death.\nThere was a clear overlapping temporal pattern across most diseases in the heat map, with most deaths during in the winter, except for mortality due to (1) malignant neoplasms and (2) unclassified symptoms, signs, and abnormal findings. It is concerning that mortality due to unclassified symptoms, signs, and abnormal findings, increased dramatically in 2023 to over 3000. Signals for all cause mortality, natural cause mortality, and mortality from cerebrovascular disease and heart disease intensified during COVID-19 period (brighter color), while mortality from diabetes mellitus persisted for a longer duration during COVID-19 (wider peak signal).\n\n\nShow code\ndf_week &lt;- df %&gt;%\n  filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n  select(`Week Ending Date`, all_of(disease_order)) %&gt;%  \n  pivot_longer(\n    cols = all_of(disease_order),\n    names_to  = \"Disease\",\n    values_to = \"Weekly Death Count\"\n  ) %&gt;%\n  rename(Year = `Week Ending Date`)\n\nmortality &lt;- c(\n  \"All Cause\",\n  \"Natural Cause\"\n  )\n\ndisease_respiratory &lt;- c(\n  \"Other diseases of respiratory system\",\n  \"Influenza and pneumonia\",\n  \"Chronic lower respiratory diseases\"\n  )\n\ndisease_covid &lt;- c(\n  \"COVID-19 (Multiple Cause of Death)\",\n  \"COVID-19 (Underlying Cause of Death)\",\n  \"COVID\"\n  )\n\ndisease_other1 &lt;- c(\n  \"Septicemia\",\n  \"Diabetes mellitus\",\n  \"Alzheimer disease\",\n  \"Cerebrovascular diseases\",\n  \"Nephritis, nephrotic syndrome and nephrosis\",\n  \"Unclassified symptoms, signs and abnormal findings\"\n  )\n\ndisease_other2 &lt;- c(\n  \"Malignant neoplasms\",\n  \"Diseases of heart\"\n  )\n\np1 &lt;- ggplot(df_week %&gt;% filter(Disease %in% mortality), \n       aes(Year, Disease, fill = `Weekly Death Count`)) +\n  geom_tile() +\n  geom_vline(xintercept = as.Date(\"2020-01-30\"), color = \"red\", linewidth = 1) +  \n  annotate(\"text\", \n           x = as.Date(\"2020-02-28\"), y = 2,          \n           label = \"COVID-19 Begins\", \n           color = \"red\", \n           hjust = 0, \n           size = 3, \n           fontface = \"bold\") +\n  scale_fill_viridis_c(option = \"C\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  scale_x_date(\n    breaks = as.Date(paste0(2014:2023, \"-01-01\")), \n    labels = date_format(\"%Y\"),\n    limits = as.Date(c(\"2013-12-25\", \"2024-01-05\")),\n    expand = c(0, 0)\n  ) +\n  labs(x = \"Year\", \n       y = \"Disease\", \n       fill = \"Weekly Death Count\") +\n  theme_minimal(base_size = 10) +\n  theme(axis.text.x = element_text(hjust = 1, angle = 0),\n        legend.position = \"top\" ) \n\np2 &lt;- ggplot(df_week %&gt;% \n               filter(Disease %in% disease_respiratory),\n             aes(Year, Disease, fill = `Weekly Death Count`)) +\n  geom_tile() +\n  geom_vline(xintercept = as.Date(\"2020-01-01\"), color = \"red\", linewidth = 1) +  \n  annotate(\"text\", \n           x = as.Date(\"2020-01-30\"), y = 2.8,          \n           label = \"COVID-19 Begins\", \n           color = \"red\", \n           hjust = 0, \n           size = 3, \n           fontface = \"bold\") +\n  scale_fill_viridis_c(option = \"D\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  scale_x_date(\n    breaks = as.Date(paste0(2014:2023, \"-01-01\")),  # ticks at Jan 1 each year\n    labels = date_format(\"%Y\"),\n    limits = as.Date(c(\"2013-12-25\", \"2024-01-05\")),\n    expand = c(0, 0)\n  ) +\n  labs(x = \"Year\", \n       y = \"Disease\", \n       fill = \"Weekly Death Count\") +\n  theme_minimal(base_size = 10) +\n  theme(axis.text.x = element_text(hjust = 1, angle = 0),\n        legend.position = \"top\" ) \n\np3 &lt;- ggplot(df_week %&gt;% filter(Disease %in% disease_covid), \n       aes(Year, Disease, fill = `Weekly Death Count`)) +\n  geom_tile() +\n  geom_vline(xintercept = as.Date(\"2020-01-01\"), color = \"red\", linewidth = 1) +  \n  annotate(\"text\", \n           x = as.Date(\"2020-02-01\"), y = 2.8,          \n           label = \"COVID-19 Begins\", \n           color = \"red\", \n           hjust = 0, \n           size = 3, \n           fontface = \"bold\") +\n  scale_fill_viridis_c(option = \"A\",\n                       na.value = \"lightgrey\",   \n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  scale_x_date(\n    breaks = as.Date(paste0(2020:2023, \"-01-01\")),  # ticks at Jan 1 each year\n    labels = date_format(\"%Y\"),\n    limits = as.Date(c(\"2013-12-25\", \"2024-01-05\")),\n    expand = c(0, 0)\n  ) +\n  labs(x = \"Year\", \n       y = \"Disease\", \n       fill = \"Weekly Death Count\") +\n  theme_minimal(base_size = 10) +\n  theme(axis.text.x = element_text(hjust = 1, angle = 0),\n        legend.position = \"top\" ) \n\np4 &lt;- ggplot(df_week %&gt;% filter(Disease %in% disease_other1), \n       aes(Year, Disease, fill = `Weekly Death Count`)) +\n  geom_tile() +\n  geom_vline(xintercept = as.Date(\"2020-01-01\"), color = \"red\", linewidth = 1) +  \n  annotate(\"text\", \n           x = as.Date(\"2020-01-30\"), y = 5.8,          \n           label = \"COVID-19 Begins\", \n           color = \"red\", \n           hjust = 0, \n           size = 3, \n           fontface = \"bold\") +\n  scale_fill_viridis_c(option = \"F\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  scale_x_date(\n    breaks = as.Date(paste0(2014:2023, \"-01-01\")),  # ticks at Jan 1 each year\n    labels = date_format(\"%Y\"),\n    limits = as.Date(c(\"2013-12-25\", \"2024-01-05\")),\n    expand = c(0, 0)\n  ) +\n  labs(x = \"Year\", \n       y = \"Disease\", \n       fill = \"Weekly Death Count\") +\n  theme_minimal(base_size = 10) +\n  theme(axis.text.x = element_text(hjust = 1, angle = 0),\n        legend.position = \"top\" ) \n\n\np5 &lt;- ggplot(df_week %&gt;% filter(Disease %in% disease_other2), \n       aes(Year, Disease, fill = `Weekly Death Count`)) +\n  geom_tile() +\n  geom_vline(xintercept = as.Date(\"2020-01-01\"), color = \"red\", linewidth = 1) +  \n  annotate(\"text\", \n           x = as.Date(\"2020-01-30\"), y = 2,          \n           label = \"COVID-19 Begins\", \n           color = \"red\", \n           hjust = 0, \n           size = 3, \n           fontface = \"bold\") +\n  scale_fill_viridis_c(option = \"E\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  scale_x_date(\n    breaks = as.Date(paste0(2014:2023, \"-01-01\")),\n    labels = date_format(\"%Y\"),\n    limits = as.Date(c(\"2013-12-25\", \"2024-01-05\")),\n    expand = c(0, 0)\n  ) +\n  labs(x = \"Year\", \n       y = \"Disease\", \n       fill = \"Weekly Death Count\") +\n  theme_minimal(base_size = 10) +\n  theme(axis.text.x = element_text(hjust = 1, angle = 0),\n        legend.position = \"top\" ) \n\n\nplot_grid(p1, p2, p3, p4, p5,\n          labels = c(\"A. Mortality of Natural Cause vs. All Cause\",\n                     \"B. Mortality Attributable to Respiratory Diseases\", \n                     \"C. Mortality Attributable to COVID-19\", \n                     \"D. Mortality Attributable to Other Diseases\",\n                     \"E. Mortality Attributable to Other Diseases cont.\"),\n          label_x = 0,    \n          label_y = 1,     \n          hjust = 0,        \n          label_size = 10, \n          label_fontface = \"bold\",\n          ncol = 1, \n          align = \"v\",\n          rel_heights = c(1.3, 1.4, 1.4, 1.8, 1.3))\n\nrm(p1, p2, p3, p4, p5)\n\n\n\n\n\nTo further access geographical variability, one disease was selected from each of the five categories in the plot above. Yearly death counts was weighted by corresponding census population estimates and then log-transformed.\nData from 2021 were used for all-cause mortality and mortality due to chronic lower respiratory disease, COVID-19, and heart disease. Data from 2023 were used for mortality due to unclassified symptoms, signs, and abnormal findings.\nThe results revealed disporportionally high mortality in West Virgina across all 5 mortality categories evaluated. Additionally, there is elevated all-cause mortality and mortality due to chronic lower respiratory disease, COVID-19, and heart disease in southeastern side of the United States, particularly in West Virginia, Mississippi, Alabama, Oklahoma, Arkansas, Tennessee, and Kentucky. Mortality due to unclassified symptoms, signs, and abnormal findings was highest in Oklahoma, West Virginia and North Carolina.\n\n\nShow code\n# https://api.census.gov/data/key_signup.html\n# census_api_key(\"14ff972ad235695086e726484ed8f894d6d96212\", install = TRUE)\n\ndf_2021 &lt;- left_join(df_year %&gt;%\n                       select(State, matches(\"2021\")) %&gt;%\n                       rename_with(~ gsub(\" 20(1[4-9]|2[0-3])$\", \"\", .x)), \n                     df_pop %&gt;% select(State, `Population 2021`),\n                     by = \"State\") %&gt;% \n  transmute(state = State,\n            Population = `Population 2021`,\n            across(\n              all_of(disease_order),\n              ~ as.numeric(gsub(\",\", \"\", .x)), \n              .names = \"{col}\"), \n            across(\n              all_of(disease_order),\n              ~ .x / as.numeric(Population), \n              .names = \"Weighted {col}\"))\n\ndf_2023 &lt;- left_join(df_year %&gt;%\n                       select(State, matches(\"2023\")) %&gt;%\n                       rename_with(~ gsub(\" 20(1[4-9]|2[0-3])$\", \"\", .x)), \n                     df_pop %&gt;% select(State, `Population 2023`),\n                     by = \"State\") %&gt;% \n  transmute(state = State,\n            Population = `Population 2023`,\n            across(\n              all_of(disease_order),\n              ~ as.numeric(gsub(\",\", \"\", .x)), \n              .names = \"{col}\"), \n            across(\n              all_of(disease_order),\n              ~ .x / as.numeric(Population), \n              .names = \"Weighted {col}\"))\n\np1 &lt;- plot_usmap(data = df_2021, \n                 regions = \"states\", \n                 values = \"Weighted All Cause\") + \n  scale_fill_viridis_c(option = \"C\",\n                       na.value = \"lightgrey\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  theme(legend.position = 'top') +\n  labs(fill = 'All Cause Mortality (2021)') +\n  guides(\n    fill = guide_colorbar(\n      title.position = \"top\", \n      title.hjust = 0.5,      \n      barwidth = unit(10, \"cm\"),\n      barheight = unit(0.3, \"cm\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\",\n    legend.title = element_text(size = 8, face = \"bold\"),\n    legend.text  = element_text(size = 8)\n  )\n\n\np2 &lt;- plot_usmap(data = df_2021, \n                 regions = \"states\", \n                 values = \"Weighted Chronic lower respiratory diseases\") + \n  scale_fill_viridis_c(option = \"D\",\n                       na.value = \"lightgrey\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  theme(legend.position = 'top') +\n  labs(fill = 'Chronic lower respiratory diseases (2021)') +\n  guides(\n    fill = guide_colorbar(\n      title.position = \"top\", \n      title.hjust = 0.5,      \n      barwidth = unit(10, \"cm\"),\n      barheight = unit(0.3, \"cm\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\",\n    legend.title = element_text(size = 8, face = \"bold\"),\n    legend.text  = element_text(size = 8)\n  )\n\n\np3 &lt;- plot_usmap(data = df_2021, \n                 regions = \"states\", \n                 values = \"Weighted COVID\") + \n  scale_fill_viridis_c(option = \"A\",\n                       na.value = \"lightgrey\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  theme(legend.position = 'top') +\n  labs(fill = 'COVID (2021)') +\n  guides(\n    fill = guide_colorbar(\n      title.position = \"top\", \n      title.hjust = 0.5,      \n      barwidth = unit(10, \"cm\"),\n      barheight = unit(0.3, \"cm\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\",\n    legend.title = element_text(size = 8, face = \"bold\"),\n    legend.text  = element_text(size = 8)\n  )\n\n\np4 &lt;- plot_usmap(data = df_2023, \n                 regions = \"states\", \n                 values = \"Weighted Unclassified symptoms, signs and abnormal findings\") + \n  scale_fill_viridis_c(option = \"F\",\n                       na.value = \"lightgrey\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  theme(legend.position = 'top') +\n  labs(fill = 'Unclassified symptoms, signs and abnormal findings Mortality (2023)') +\n  guides(\n    fill = guide_colorbar(\n      title.position = \"top\", \n      title.hjust = 0.5,      \n      barwidth = unit(10, \"cm\"),\n      barheight = unit(0.3, \"cm\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\",\n    legend.title = element_text(size = 8, face = \"bold\"),\n    legend.text  = element_text(size = 8)\n  )\n\np5 &lt;- plot_usmap(data = df_2021, \n                 regions = \"states\", \n                 values = \"Weighted Diseases of heart\") + \n  scale_fill_viridis_c(option = \"E\",\n                       na.value = \"lightgrey\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  theme(legend.position = 'top') +\n  labs(fill = 'Diseases of heart (2021)') +\n  guides(\n    fill = guide_colorbar(\n      title.position = \"top\", \n      title.hjust = 0.5,      \n      barwidth = unit(10, \"cm\"),\n      barheight = unit(0.3, \"cm\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\",\n    legend.title = element_text(size = 8, face = \"bold\"),\n    legend.text  = element_text(size = 8)\n  )\n\ntop &lt;- plot_grid(\n  p1,\n  labels = c(\"A.\"),\n  label_size = 8, \n  ncol = 1, align = \"hv\")\n\nbottom &lt;- plot_grid(\n  p2,\n  p3,\n  p4,\n  p5,\n  labels = c(\"B.\", \"C.\", \n             \"D.\", \"E\"),\n  label_size = 8, \n  ncol = 2, align = \"hv\")\n\nplot_grid(\n  top,\n  bottom,\n  ncol = 1,\n  align = \"v\",\n  rel_heights = c(1, 2)\n)\n\nrm(df_2021, df_2023, p1, p2, p3, p4, p5, top, bottom)\n\n\n\n\n\n\nHere, I examined mortality trends in the United States between 2014-2023 across multiple causes of death, in terms of geographical and temporal patterns. Overall, mortality for most diseases increased during the COVID-19 period. Mortality from unclassified symptoms, signs, and abnorfmal findings increased sharply in 2023. There is clear seasonal patterns, with mortality lowest in summer and peak in winter. The winter of 2020-2021 showed peaks of the COVID-19 pandemic impact. Geographically, there is disproportionately high mortality in southeastern United States, particularly West Virginia, Alabama, Mississippi, across multiple causes of deaths.\n\n\n\n(1) Lack of individual level data. Unable to investigate how COVID affect different age groups, race, sex, SES, etc. (2) Lack of analysis on flags for other diseases/complications. (3) Limited reporting in 2023.\n\n\n\nI used ChatGPT to (1) Revise regular expression, highlight what’s wrong and why it won’t work, (2) Find a simpler way to do mutate and then select (ChatGPT: transmute), (3) Set column width in kable (ChatGPT: column_spec(1, width = \"10cm\")), (4) Find simpler way to mutate parameters across multiple columns rather than running mutate for a million times (ChatGPT: across(all_of(disease_order), ~ as.numeric(gsub(\",\", \"\", .x)), .names = \"{col}\")), (5) Search how to change text alignment and add caption in qmd, (6) check grammar."
  },
  {
    "objectID": "midterm.html#midterm-project",
    "href": "midterm.html#midterm-project",
    "title": "Analysis of the United States",
    "section": "",
    "text": "Show code\nsuppressPackageStartupMessages(library(data.table))\nsuppressPackageStartupMessages(library(tidyverse))\nsuppressPackageStartupMessages(library(lubridate))\nsuppressPackageStartupMessages(library(scales))\nsuppressPackageStartupMessages(library(purrr))\nsuppressPackageStartupMessages(library(tidycensus))\n\nsuppressPackageStartupMessages(library(skimr))\nsuppressPackageStartupMessages(library(knitr))\nsuppressPackageStartupMessages(library(kableExtra))\n\nsuppressPackageStartupMessages(library(ggmap))\nsuppressPackageStartupMessages(library(ggplot2))\nsuppressPackageStartupMessages(library(usmap))\nsuppressPackageStartupMessages(library(cowplot))\nsuppressPackageStartupMessages(library(RColorBrewer))\n\n\n\n\nBackground. COVID-19 pandemic took millions of lives and has profound impact on global health. It also influenced mortality from other diseases through comorbidity, disruptions in health care access, and changes in life styles. In this analysis, I compare geotemporal mortlity patterns in the United States before (2014-2019) and during (2020-2023) COVID-19 pandemic to understand how overall and cause-specific death changed across time and region.\nEDA. The primary object of the exploratory data analysis is to check:\n\nDo we have death count for each year and each week?\nWhat is the distribution of weekly death count for each disease and each year? How do those distribution differ before and during COVID-19?\nWhat is the yearly death count / precentage (using Census estimates) for each State?\n\nAnalysis. The primary object of this project is to evaluate:\n\nWhen dividing data to pre COVID-19 (2014 - 2019) and during COVID-19 (2020 - 2023) periods, what’s the percent change in mean weekly death count for each disease?\nIs there temporal patterns for disease-specific death counts between 2014 - 2023? How do these patterns align with COVID-19 death pattern? Which month has the lowest/highest of weekly death? How do monthly death counts vary across each year?\nWhich State has the highest disease-specific death (weighted by census estimation of population)? Is there any region disproportionately affected?\n\n\n\n\nWeekly count of death by state and select causes in 2014-2019 vs 2020-2023 were exported from CDC. US Census Estimates were pulled from usmap package.\nThe data sets for 2020-2023 includes additional columns, COVID-19 (U071, Multiple Cause of Death) and COVID-19 (U071, Underlying Cause of Death), due to COVID19 pandemic. Additionally, deaths caused by influenza and pneumonia category changed from J10-J18 (2014-2019) to J09-J18 (2020-2023).\nHere, I converted count of death columns in both data sets from chr to numeric and Week Ending Date column in 2014-2019 data set from chr to IDate. Next, I manually added columns that were missing in either data set (i.e., present in one data set but not the other) and set their values to NA. Then, I create a new column named Dataset Type to distinguish data from 2015-2019 and 2020-2023. Finally, I combined two data sets into one. Additionally, I created a new variable named Influenza and pneumonia that combines Influenza and pneumonia (J10-J18) from 2014-2019 and Influenza and pneumonia (J09-J18) from 2020-2023.\n\n\nShow code\nidir      &lt;- \"/Users/xinranwang/Documents/Course/25Fall/PM566/Data\"\nfilename1 &lt;- \"Weekly_Counts_of_Deaths_by_State_and_Select_Causes,_2014-2019_20251015.csv\"\nfilename2 &lt;- \"Weekly_Provisional_Counts_of_Deaths_by_State_and_Select_Causes,_2020-2023_20251015.csv\"\n\n\n\n\nShow code\ndf_2014_2019 &lt;- fread(paste0(idir, \"/\", filename1))\ndf_2020_2023 &lt;- fread(paste0(idir, \"/\", filename2))\n\n# setequal(names(df_2014_2019), names(df_2020_2023))  # Check if colnames are same: No\n# setdiff(names(df_2014_2019), names(df_2020_2023))   # Columns in 2014-19 but not 2020-23\n# setdiff(names(df_2020_2023), names(df_2014_2019))   # Columns in 2020-23 but not 2014-19\n\ndf_2014_2019 &lt;- df_2014_2019 %&gt;% \n  mutate(across(5:17, ~ as.numeric(gsub(\",\", \"\", .x))),\n         `Dataset Type`                               = \"2014-2019\", \n         `Influenza and pneumonia (J09-J18)`          = NA,\n         `Data As Of`                                 = NA, \n         `COVID-19 (U071, Multiple Cause of Death)`   = NA, \n         `COVID-19 (U071, Underlying Cause of Death)` = NA, \n         `flag_cov19mcod`                             = NA, \n         `flag_cov19ucod`                             = NA,\n         `Week Ending Date` = as.IDate(`Week Ending Date`, format = \"%m/%d/%Y\")) %&gt;%\n  rename(`All Cause` = `All  Cause`) \n\ndf_2020_2023 &lt;- df_2020_2023 %&gt;% \n  mutate(across(6:20, ~ as.numeric(gsub(\",\", \"\", .x))),\n         `Dataset Type`                               = \"2020-2023\", \n         `Influenza and pneumonia (J10-J18)`          = NA)\n\n# setequal(names(df_2014_2019), names(df_2020_2023))  # Check if colnames are same: Yes\n\ndf &lt;- bind_rows(df_2014_2019, df_2020_2023)\n\ndf &lt;- df %&gt;%\n    mutate(`Influenza and pneumonia` = \n             coalesce(`Influenza and pneumonia (J09-J18)`,\n                      `Influenza and pneumonia (J10-J18)`),\n           `COVID` = rowSums(across(c(\n             `COVID-19 (U071, Multiple Cause of Death)`, \n             `COVID-19 (U071, Underlying Cause of Death)`))))\n\nrm(df_2014_2019, df_2020_2023, filename1, filename2)\n\ndisease_order &lt;- c(\n  \"All Cause\",\n  \"Natural Cause\",\n  \"Unclassified symptoms, signs and abnormal findings\",\n  \"Septicemia\",\n  \"Nephritis, nephrotic syndrome and nephrosis\",\n  \"Diabetes mellitus\",\n  \"Alzheimer disease\",\n  \"Cerebrovascular diseases\",\n  \"Malignant neoplasms\",\n  \"Diseases of heart\",\n  \"Other diseases of respiratory system\",\n  \"Influenza and pneumonia\",\n  \"Chronic lower respiratory diseases\",\n  \"COVID-19 (Multiple Cause of Death)\",\n  \"COVID-19 (Underlying Cause of Death)\",\n  \"COVID\"\n  )\n\nyears_palette &lt;- viridisLite::plasma(10)\nyears &lt;- 2014:2023\nnames(years_palette) &lt;- years\n\ndf &lt;- df %&gt;% \n  rename(\n    Septicemia                 = `Septicemia (A40-A41)`,\n    `Malignant neoplasms`      = `Malignant neoplasms (C00-C97)`,\n    `Alzheimer disease`        = `Alzheimer disease (G30)`,\n    `Diabetes mellitus`        = `Diabetes mellitus (E10-E14)`,\n    `Diseases of heart`        = `Diseases of heart (I00-I09,I11,I13,I20-I51)`,\n    `Cerebrovascular diseases` = `Cerebrovascular diseases (I60-I69)`,\n    `Nephritis, nephrotic syndrome and nephrosis` = \n      `Nephritis, nephrotic syndrome and nephrosis (N00-N07,N17-N19,N25-N27)`,\n    `Unclassified symptoms, signs and abnormal findings` = \n      `Symptoms, signs and abnormal clinical and laboratory findings, not elsewhere classified (R00-R99)`,\n    `Chronic lower respiratory diseases` = \n      `Chronic lower respiratory diseases (J40-J47)`,\n    `Other diseases of respiratory system` = \n      `Other diseases of respiratory system (J00-J06,J30-J39,J67,J70-J98)`,\n    `COVID-19 (Multiple Cause of Death)`   = `COVID-19 (U071, Multiple Cause of Death)`,\n    `COVID-19 (Underlying Cause of Death)` = `COVID-19 (U071, Underlying Cause of Death)`\n  ) %&gt;%\n  select(c(\"Jurisdiction of Occurrence\",\n           \"MMWR Year\",\n           \"MMWR Week\",\n           \"Week Ending Date\"),\n         any_of(disease_order), everything())\n\n\n\n\n\n\n\nAfter combining and cleaning dataset from 2014-2019 and 2020-2023, the final data set contains 27,378 rows and 38 columns. The data include location information (USA and individual states), temporal patterns (year and week start date), weekly death count by various disease, and indicator flags for relevant diseases.\nDeath counts are categorized as total (all-cause), natural cause, and 12 specific diseases. COVID-19 is further divided into multiple cause and underlying cause of deaths.\n\n\nShow code\n# Skim everything except IDate column:\nskim(df %&gt;% select(-`Week Ending Date`))\n\n# For IDate formatted column:\nprint(paste0(\"Number of rows of Week Ending Date: \", length(df$`Week Ending Date`)))\nprint(paste0(\"Completeness: \", \n             length(!is.na(df$`Week Ending Date`)) / length(df$`Week Ending Date`)))\nstr(df$`Week Ending Date`)\nsummary(df$`Week Ending Date`)\n\n# Head and Tail\nhead(df, 5)\ntail(df, 5)\n\n\n\n\n\nI began by checking number of weeks reported per year. All COVID-19 related categories shared the same number of weeks, as did all non-COVID diseases (although the the two groups differs from each other). Thus, I summarized the data by collapsing them into 2 rows: number of weeks for COVID and for non-COVID diseases.\n\n\nShow code\ndf_count_week &lt;- df %&gt;%\n  filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n  rename(Year = `MMWR Year`, Week = `MMWR Week`) %&gt;%\n  transmute(\n    Year, Week,\n    across(all_of(disease_order), ~ as.numeric(gsub(\",\", \"\", .x)))\n  ) %&gt;%\n  arrange(Year, Week) %&gt;%\n  group_by(Year) %&gt;%\n  summarise(across(all_of(disease_order), ~ sum(!is.na(.x)))) %&gt;%\n  ungroup() %&gt;%\n  pivot_longer(-Year, names_to = \"Disease\", values_to = \"Weeks\") %&gt;%\n  pivot_wider(names_from = Year, values_from = Weeks)\n\ndf_count_week_collapsed &lt;- df_count_week %&gt;%\n  group_by(across(-Disease)) %&gt;%   \n  summarise(Diseases = paste(Disease, collapse = \", \")) %&gt;%\n  ungroup() %&gt;%\n  select(Diseases, everything())\n\nkable(df_count_week_collapsed,\n      align = c(\"l\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\"),\n      caption = \"Table 1. Number of Weeks Recorded in United States per Year\") %&gt;%\n  kable_styling(full_width = FALSE) %&gt;%\n  column_spec(1, width = \"10cm\") \n\nrm(df_count_week, df_count_week_collapsed)\n\n\n\n\n\nThen, I plotted the distribution of weekly death count for each disease from 2014 to 2023. Most diseases show a clear rightward shift from pre COVID-19 period to during COVID-19 period, except influenza and phenomena and chronic lower respiratory disease, which is likely due to public health measures implemented during COVID (such as mask wearing, physical distancing, etc). There is a significant decrease in weekly death count for COVID in 2023 (as compared to 2020 - 2022), likely due to reduced reporting (See Table 2).\n\n\nShow code\nplot_disease_distribution &lt;- function(disease_col, bins = 30, show_legend = FALSE) {\n  if (grepl(\"COVID\", disease_col, ignore.case = TRUE)) {\n    dat &lt;- df %&gt;% filter(`MMWR Year` &gt;= 2020)\n  } else {\n    dat &lt;- df\n  }\n  \n  dat &lt;- dat %&gt;%\n    rename(Year = `MMWR Year`) %&gt;%\n    filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n    transmute(\n      Year = factor(Year),  \n      Count = as.numeric(gsub(\",\", \"\", .data[[disease_col]]))\n    )\n\n  ggplot(dat, aes(x = Count, fill = Year)) +\n    geom_histogram(bins = bins, color = \"white\", alpha = 0.7, position = \"identity\") + \n    labs(title = disease_col, x = \"Weekly Death Count\", y = \"Count\") +\n    scale_x_continuous(labels = scales::comma) +\n    scale_fill_manual(values = years_palette, drop = T) +\n    theme_minimal(base_size = 8) +\n    theme(\n      plot.title  = element_text(size = 8, face = \"bold\"),\n      axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n      axis.text.y = element_text(size = 8),\n      legend.position = if (show_legend) \"bottom\" else \"none\"\n    )\n}\n\nplot_list &lt;- lapply(disease_order, plot_disease_distribution, bins = 30)\nmain_plot &lt;- plot_grid(\n  plotlist = plot_list,\n  ncol=4\n  )\n\nplot_for_legend &lt;- plot_disease_distribution(disease_order[1], 30, show_legend = T) +\n  ggplot2::theme(legend.position = \"bottom\")\nlegend &lt;- cowplot::ggdraw(get_plot_component(plot_for_legend, 'guide-box-bottom', return_all = TRUE))\n\nplot_grid(\n  plotlist = c(main_plot, legend),\n  ncol=1,\n  label_size = 8,                           \n  label_fontface = \"bold\", \n  rel_heights = c(1, 0.1)\n)\n\nrm(plot_disease_distribution, plot_list, main_plot, plot_for_legend, legend)\n\n\n\n\n\nAdditionally, I evaluated COVID-19 death count by State for all diseases. West Virginia, Alabama, Arizona, Mississippi, Tennessee were among the most severely affected States in 2021, each reporting COVID-19 mortality exceeding 0.37% of their population.\n\n\nShow code\ndf_year &lt;- df %&gt;%\n  filter(`Jurisdiction of Occurrence` != \"United States\") %&gt;%\n  rename(\n    State = `Jurisdiction of Occurrence`,\n    Year  = `MMWR Year`,\n    Week  = `MMWR Week`\n  ) %&gt;%\n  transmute(\n    State,\n    Year,\n    across(all_of(disease_order), ~ as.numeric(gsub(\",\", \"\", .x)))\n  ) %&gt;%\n  group_by(State, Year) %&gt;%\n  summarise(across(all_of(disease_order), sum, na.rm = TRUE)) %&gt;%\n  ungroup %&gt;%\n  pivot_longer(all_of(disease_order), \n               names_to = \"Disease\", \n               values_to = \"Count\") %&gt;%\n  pivot_wider(\n    names_from  = c(Disease, Year),\n    values_from = Count,\n    names_sep   = \" \"\n  ) %&gt;%\n  arrange(State)\n\n#\ndf_pop &lt;- map_dfr(\n  2020:2023,\n  ~ get_estimates(geography = \"state\", product = \"population\", year = .x) %&gt;%\n    filter(variable == \"POPESTIMATE\") %&gt;%\n    transmute(State = NAME, Year = .x, Population = value)\n  )\n  \ndf_pop &lt;- df_pop %&gt;%\n  tidyr::pivot_wider(names_from = Year, values_from = Population,\n                     names_prefix = \"Population \")\n\nkable(left_join(\n  df_year %&gt;% \n    select(State, matches(\"COVID 202\")) %&gt;%\n    rename_with(~ gsub(\"COVID \", \"\", .x)), \n  df_pop, \n  by = \"State\") %&gt;%\n    mutate(\n      `2020 Count (%)` = paste0(format(`2020`, big.mark=\",\"), \" (\", \n                      format(round((`2020` / `Population 2020`) * 100, 2), \n                             big.mark=\",\"), \"%)\"), \n      `2021 Count (%)` = paste0(format(`2021`, big.mark=\",\"), \" (\", \n                      format(round((`2021` / `Population 2021`) * 100, 2), \n                             big.mark=\",\"), \"%)\"),\n      `2022 Count (%)` = paste0(format(`2022`, big.mark=\",\"), \" (\", \n                      format(round((`2022` / `Population 2022`) * 100, 2), \n                             big.mark=\",\"), \"%)\"), \n      `2023 Count (%)` = paste0(format(`2023`, big.mark=\",\"), \" (\", \n                      format(round((`2023` / `Population 2023`) * 100, 2), \n                             big.mark=\",\"), \"%)\")) %&gt;%\n    select(c(State, `2020 Count (%)`, `2021 Count (%)`, `2022 Count (%)`, `2023 Count (%)`)),\n  align = c(\"l\", \"c\", \"c\", \"c\"), \n  caption = \"Table 2. COVID Death by State (2020-2023)\")\n\n\n\n\n\n\n\n\nFirst, I evaluate the trend of weekly all cause mortality from 2014 to 2023 in the United States. Overall, summer months (June - August) tends to have fewest death, whereas winter (December - January) tends to have the highest number of deaths. December 2020 - January 2021 were the peak periods of COVID-19 impact, with weekly deaths reaching 87,033 in December and 87,415 in January.\n\n\nShow code\nkable(df %&gt;%\n        filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n        mutate(Month = month(as.Date(`Week Ending Date`) - 3, label = TRUE, abbr = TRUE)) %&gt;%\n        rename(Year = `MMWR Year`) %&gt;%\n        group_by(Year) %&gt;%\n        summarize(\n          `Min (Mo.)` = paste0(format(round(min(`All Cause`, na.rm = TRUE), 0), \n                                      big.mark=\",\"), \n                               \" (\", Month[which.min(`All Cause`)], \".)\"),\n          `1st quartile` = format(round(quantile(`All Cause`, 0.25, na.rm = TRUE),0), \n                                  big.mark=\",\"),\n          `Median`       = format(round(quantile(`All Cause`, 0.5,  na.rm = TRUE), 0), \n                                  big.mark=\",\"),\n          `Mean`         = format(round(mean(`All Cause`, na.rm = TRUE),0), big.mark=\",\"),\n          `3rd quartile` = format(round(quantile(`All Cause`, 0.75, na.rm = TRUE),0), \n                                  big.mark=\",\"),\n          `Max (Mo.)`    = paste0(format(round(max(`All Cause`, na.rm = TRUE), 0), \n                                         big.mark=\",\"),\n                                  \" (\", Month[which.max(`All Cause`)], \".)\"),\n          `Mean (SD)`    = paste0(Mean, \" (\", round(sd(`All Cause`,na.rm = TRUE), 0), \")\")) %&gt;%\n        select(Year, `Min (Mo.)`, `1st quartile`, `Mean (SD)`, everything()),\n  caption = \"Table 3. Summary Statistics of Weekly All Cause Death (2014-2023) in United States\",\n  align = \"c\")\n\n\n\n\n\nHere, I accessed mean weekly death for each disease before (2014-2019) and during (2020-2023) COVID-19 pandemic in the United States. The corresponding percentage change was also calculated.\nBoth all causes of death and nature cause of death increased approximately 19%. Most diseases showed an overall percentage increase (greater than population growth rate of 0.52%) in deaths. Specifically, there was substantial increase in mortality from unclassified symptoms, signs and abnormal findings, diabetes mellitus, other diseases of respiratory system, cerebrovascular diseases (36.58%, 22.29%, 15.7%, 13.09% increase, respectively). Mortality due Influenza and chronic lower respiratory disease decreased by 14.58% and 5.7%, likely due to death being re-classified as COVID-19 related deaths (either as multiple or underlying causes).\n\n\nShow code\nkable(df %&gt;%\n        dplyr::filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n        group_by(`Dataset Type`) %&gt;%\n        summarise(\n          across(all_of(disease_order), \n                 ~ round(mean(as.numeric(.x), na.rm = TRUE),2), \n                 .names = \"{col}\")) %&gt;%\n        ungroup() %&gt;%\n        pivot_longer(-`Dataset Type`, \n                     names_to = \"Variable\", \n                     values_to = \"Mean\") %&gt;%\n        pivot_wider(names_from = `Dataset Type`, \n                    values_from = Mean) %&gt;%\n        mutate(`% Change` = \n                 paste0(\n                   round(((`2020-2023` - `2014-2019`) / `2014-2019`) * 100, 2), \"%\"),\n               `2014-2019` = format(round(`2014-2019`, 0), big.mark = \",\"),\n               `2020-2023` = format(round(`2020-2023`, 0), big.mark = \",\")),\n      caption = \"Table 4. Summary Statistics of Mean Weekly Mortality (Before vs During COVID-19) in United States\",\n      align = c(\"l\", \"c\", \"c\", \"c\")) %&gt;%\n  kable_styling(full_width = FALSE) %&gt;%\n  column_spec(1, width = \"10cm\")\n\n\n\n\n\nNext, I examined mean weekly death for each disease per year in the United States. Note that mean weekly death were used instead of annual death count because only 37 weeks was recorded in 2023.\nI observed similar trends all-cause and natural-cause mortality, as well as death due to nephritis, nephrotic syndrome and nephrosis, diabetes mellitus, cerebrovascular diseases, malignant neoplass, diseases of the heart. Mortality showed slightly upward trend during pre COVID-19 years (2014-2019), followed by a sharp increase from 2019-2020. The upward trend continued at a slower rate between 2020-2021 and declined from 2021-2023. However, mortality levels remained higher than those in 2019, consistent with the pre COVID-19 increasing trend.\nThere is similar pattern for other disease with respiratory system, except that mortality did not decline after 2021. Septicemia exhibited a sharp decline in 2019, followed by a steady rise from 2020-2022, peaking in 2022, which aligns with the context of COVID-19 as Septicemia can result from an excessive immune response. Mortality due to Alzheimer’s disease showed a substantial increase in 2020. Deaths due to influenza and pneumonia and chronic lower respiratory diseases declined, likely due to public health measures. Deaths attributable to unclassified symptoms, signs and abnormal findings rose sharply in 2023.\nPatterns by year\n\n\nShow code\n################## Average Weekly Death per Year\nplot_disease_yearly &lt;- function(disease_col, line_col = \"steelblue\") {\n  \n  dat &lt;- df %&gt;%\n    filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n    transmute(\n      `MMWR Year`,\n      `Week Ending Date`,\n      Count = as.numeric(gsub(\",\", \"\", .data[[disease_col]])) \n    ) %&gt;%\n    group_by(`MMWR Year`) %&gt;%\n    summarise(\n      Mean  = mean(Count, na.rm = TRUE),\n      SD    = sd(Count,   na.rm = TRUE),\n      SE    = SD / sqrt(sum(!is.na(Count)))\n    ) %&gt;%\n    ungroup() %&gt;%\n    rename(Year = `MMWR Year`)\n    \n  ggplot(dat, aes(x = Year, y = Mean)) +\n    geom_line(linewidth = 1, color = line_col) +\n    geom_point(size = 2, color = line_col) +\n    geom_errorbar(aes(ymin = Mean - SE, ymax = Mean + SE),\n                  width = 0.2, color = line_col) +\n    labs(\n      title = disease_col,\n      x = \"Year\",\n      y = \"Avg Weekly Death Count\"\n    ) +\n    scale_x_continuous(breaks = 2014:2023, limits = c(2014, 2023)) +\n    theme_minimal(base_size = 8) +\n    theme(plot.title  = element_text(size = 8, face = \"bold\"),\n          axis.text.x = element_text(hjust = 1, angle = 45)) \n}\n\nplots_list &lt;- map(disease_order, plot_disease_yearly)\n\nplot_grid(\n  plotlist = plots_list,\n  ncol = 4,\n  align = \"hv\",\n  labels = paste0(LETTERS[seq_along(plots_list)], \".\"),\n  label_x = 0, hjust = 0, label_size = 8\n)\n\nrm(plot_disease_yearly, plots_list)\n\n\nPatterns by Month and Year\nSince Table 3 shows that the minimum weekly death count typically occur during summer and the maximized during winter, I further examined seasonal pattern by plotting monthly death counts by month and year.\nThe results showed U-shaped trend in monthly deaths, with lowest in summer and highest in winter, for all death count categories except malignant neoplasms. Additionally, the death count for 2020-2023 is generally higher than than those for 2014-2019, consistent with the findings in Table 4.\n\n\nShow code\n################## Average Monthly Death per Year\nplot_disease_monthly &lt;- function(disease_col, show_legend = FALSE, year_start, year_end) {\n  \n  dat &lt;- df %&gt;%\n    filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n    transmute(\n      `MMWR Year`,\n      `Week Ending Date`,\n      Month = month(as.Date(`Week Ending Date`)),\n      Year = as.character( `MMWR Year`),\n      #Weekly_Count = as.numeric(gsub(\",\", \"\", `All Cause`))\n      Weekly_Count = as.numeric(gsub(\",\", \"\", .data[[disease_col]]))\n    ) %&gt;%\n    group_by(Year, Month) %&gt;%\n    summarize(Monthly_Count = sum(Weekly_Count, na.rm=T)) %&gt;%\n    ungroup()\n  \n  ymax &lt;- max(dat$Monthly_Count, na.rm=T)\n  ymin &lt;- min(dat$Monthly_Count, na.rm=T) \n  \n  ymax_2014_2019 &lt;- (dat %&gt;%\n    filter(Year &gt;= 2014, Year &lt;= 2019) %&gt;%\n    summarise(ymax = max(Monthly_Count, na.rm = TRUE)))$ymax\n  ymin_2014_2019 &lt;- (dat %&gt;%\n    filter(Year &gt;= 2014, Year &lt;= 2019) %&gt;%\n    summarise(ymin = min(Monthly_Count, na.rm = TRUE)))$ymin\n  \n  dat &lt;- dat %&gt;% filter(Year &gt;= year_start & Year &lt;= year_end) \n    \n  ggplot(dat, aes(x = Month, y = Monthly_Count, color = Year, group = Year)) +\n    geom_hline(yintercept = ymax_2014_2019, linewidth = 0.5, color = \"grey\") +\n    geom_hline(yintercept = ymin_2014_2019, linewidth = 0.5, color = \"grey\") +\n    annotate(\"rect\", xmin = -Inf, xmax = Inf, ymin = ymin_2014_2019, ymax = ymax_2014_2019,\n           alpha = 0.2, fill = \"lightgrey\") +\n    geom_line(linewidth = 0.5, alpha = 0.7) +\n    geom_point(size = 1) +\n    labs(\n      title = disease_col,\n      subtitle = paste0(year_start, \"-\", year_end),\n      x = \"Month\",\n      y = \"Monthly Death Count\"\n    ) +\n    scale_color_manual(values = years_palette, drop = T) +\n    scale_x_continuous(breaks = 1:12, limits = c(1, 12)) +\n    scale_y_continuous(labels = comma, limits = c(ymin, ymax)) +\n    theme_minimal(base_size = 8) +\n    theme(\n      plot.title  = element_text(size = 8, face = \"bold\"),\n      axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n      axis.text.y = element_text(size = 8),\n      legend.position = if (show_legend) \"bottom\" else \"none\"\n    )\n}\n\n#\nplots_list_2014_2019_1 &lt;- map(disease_order[1:8], ~ plot_disease_monthly(.x, FALSE, 2014, 2019))\nmain_plot_2014_2019_1 &lt;- plot_grid(\n  plotlist = plots_list_2014_2019_1,\n  ncol = 1,\n  align = \"hv\",\n  labels = c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\"),\n  label_x = 0, hjust = 0, label_size = 8\n)\n\nplots_list_2014_2019_2 &lt;- map(disease_order[9:16], ~ plot_disease_monthly(.x, FALSE, 2014, 2019))\nmain_plot_2014_2019_2 &lt;- plot_grid(\n  plotlist = plots_list_2014_2019_2,\n  ncol = 1,\n  align = \"hv\",\n  labels = c(\"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\"),\n  label_x = 0, hjust = 0, label_size = 8\n)\n\n#\nplots_list_2020_2023_1 &lt;- map(disease_order[1:8], ~ plot_disease_monthly(.x, FALSE, 2020, 2023))\nmain_plot_2020_2023_1 &lt;- plot_grid(\n  plotlist = plots_list_2020_2023_1,\n  ncol = 1,\n  align = \"hv\",\n  label_x = 0, hjust = 0, label_size = 8\n)\n\nplots_list_2020_2023_2 &lt;- map(disease_order[9:16], ~ plot_disease_monthly(.x, FALSE, 2020, 2023))\nmain_plot_2020_2023_2 &lt;- plot_grid(\n  plotlist = plots_list_2020_2023_2,\n  ncol = 1,\n  align = \"hv\",\n  label_x = 0, hjust = 0, label_size = 8\n)\n\n#\nplot_for_legend &lt;- plot_disease_monthly(disease_order[1], TRUE, 2014, 2023) +\n  ggplot2::theme(legend.position = \"bottom\")\nlegend &lt;- cowplot::ggdraw(get_plot_component(plot_for_legend, 'guide-box-bottom', return_all = TRUE))\n\n#\nmerged_plot &lt;- plot_grid(\n  plotlist = c(main_plot_2014_2019_1, main_plot_2020_2023_1, \n               main_plot_2014_2019_2, main_plot_2020_2023_2),\n  ncol=4,\n  label_size = 8,                           \n  label_fontface = \"bold\"\n)\n\n#\nplot_grid(\n  plotlist = c(merged_plot, legend),\n  ncol=1,\n  label_size = 8,                           \n  label_fontface = \"bold\", \n  rel_heights = c(1, 0.1)\n)\n\nrm(plot_disease_monthly, dat,\n   ymin, ymax, ymin_2014_2019, ymax_2014_2019,\n   plots_list_2014_2019_1, plots_list_2014_2019_2, \n   main_plot_2014_2019_1, main_plot_2014_2019_2,\n   plots_list_2020_2023_1, plots_list_2020_2023_2,\n   main_plot_2020_2023_1, main_plot_2020_2023_2,\n   plot_for_legend, merged_plot)\n\n\n\n\n\nHere, I evaluated mortality by disease and by week of the year in the United States. Weekly mortality counts was divided by five categories: (1) mortality of nature cause or all causes, (2) mortality attributable to respiratory diseases, (3) mortality attributable to COVID-19, (4) mortality attributable to other diseases with lower mortality counts, and (5) mortality attributable to other diseases with higher mortality counts. The categorization was applied as mortality differ across various causes of death.\nThere was a clear overlapping temporal pattern across most diseases in the heat map, with most deaths during in the winter, except for mortality due to (1) malignant neoplasms and (2) unclassified symptoms, signs, and abnormal findings. It is concerning that mortality due to unclassified symptoms, signs, and abnormal findings, increased dramatically in 2023 to over 3000. Signals for all cause mortality, natural cause mortality, and mortality from cerebrovascular disease and heart disease intensified during COVID-19 period (brighter color), while mortality from diabetes mellitus persisted for a longer duration during COVID-19 (wider peak signal).\n\n\nShow code\ndf_week &lt;- df %&gt;%\n  filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n  select(`Week Ending Date`, all_of(disease_order)) %&gt;%  \n  pivot_longer(\n    cols = all_of(disease_order),\n    names_to  = \"Disease\",\n    values_to = \"Weekly Death Count\"\n  ) %&gt;%\n  rename(Year = `Week Ending Date`)\n\nmortality &lt;- c(\n  \"All Cause\",\n  \"Natural Cause\"\n  )\n\ndisease_respiratory &lt;- c(\n  \"Other diseases of respiratory system\",\n  \"Influenza and pneumonia\",\n  \"Chronic lower respiratory diseases\"\n  )\n\ndisease_covid &lt;- c(\n  \"COVID-19 (Multiple Cause of Death)\",\n  \"COVID-19 (Underlying Cause of Death)\",\n  \"COVID\"\n  )\n\ndisease_other1 &lt;- c(\n  \"Septicemia\",\n  \"Diabetes mellitus\",\n  \"Alzheimer disease\",\n  \"Cerebrovascular diseases\",\n  \"Nephritis, nephrotic syndrome and nephrosis\",\n  \"Unclassified symptoms, signs and abnormal findings\"\n  )\n\ndisease_other2 &lt;- c(\n  \"Malignant neoplasms\",\n  \"Diseases of heart\"\n  )\n\np1 &lt;- ggplot(df_week %&gt;% filter(Disease %in% mortality), \n       aes(Year, Disease, fill = `Weekly Death Count`)) +\n  geom_tile() +\n  geom_vline(xintercept = as.Date(\"2020-01-30\"), color = \"red\", linewidth = 1) +  \n  annotate(\"text\", \n           x = as.Date(\"2020-02-28\"), y = 2,          \n           label = \"COVID-19 Begins\", \n           color = \"red\", \n           hjust = 0, \n           size = 3, \n           fontface = \"bold\") +\n  scale_fill_viridis_c(option = \"C\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  scale_x_date(\n    breaks = as.Date(paste0(2014:2023, \"-01-01\")), \n    labels = date_format(\"%Y\"),\n    limits = as.Date(c(\"2013-12-25\", \"2024-01-05\")),\n    expand = c(0, 0)\n  ) +\n  labs(x = \"Year\", \n       y = \"Disease\", \n       fill = \"Weekly Death Count\") +\n  theme_minimal(base_size = 10) +\n  theme(axis.text.x = element_text(hjust = 1, angle = 0),\n        legend.position = \"top\" ) \n\np2 &lt;- ggplot(df_week %&gt;% \n               filter(Disease %in% disease_respiratory),\n             aes(Year, Disease, fill = `Weekly Death Count`)) +\n  geom_tile() +\n  geom_vline(xintercept = as.Date(\"2020-01-01\"), color = \"red\", linewidth = 1) +  \n  annotate(\"text\", \n           x = as.Date(\"2020-01-30\"), y = 2.8,          \n           label = \"COVID-19 Begins\", \n           color = \"red\", \n           hjust = 0, \n           size = 3, \n           fontface = \"bold\") +\n  scale_fill_viridis_c(option = \"D\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  scale_x_date(\n    breaks = as.Date(paste0(2014:2023, \"-01-01\")),  # ticks at Jan 1 each year\n    labels = date_format(\"%Y\"),\n    limits = as.Date(c(\"2013-12-25\", \"2024-01-05\")),\n    expand = c(0, 0)\n  ) +\n  labs(x = \"Year\", \n       y = \"Disease\", \n       fill = \"Weekly Death Count\") +\n  theme_minimal(base_size = 10) +\n  theme(axis.text.x = element_text(hjust = 1, angle = 0),\n        legend.position = \"top\" ) \n\np3 &lt;- ggplot(df_week %&gt;% filter(Disease %in% disease_covid), \n       aes(Year, Disease, fill = `Weekly Death Count`)) +\n  geom_tile() +\n  geom_vline(xintercept = as.Date(\"2020-01-01\"), color = \"red\", linewidth = 1) +  \n  annotate(\"text\", \n           x = as.Date(\"2020-02-01\"), y = 2.8,          \n           label = \"COVID-19 Begins\", \n           color = \"red\", \n           hjust = 0, \n           size = 3, \n           fontface = \"bold\") +\n  scale_fill_viridis_c(option = \"A\",\n                       na.value = \"lightgrey\",   \n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  scale_x_date(\n    breaks = as.Date(paste0(2020:2023, \"-01-01\")),  # ticks at Jan 1 each year\n    labels = date_format(\"%Y\"),\n    limits = as.Date(c(\"2013-12-25\", \"2024-01-05\")),\n    expand = c(0, 0)\n  ) +\n  labs(x = \"Year\", \n       y = \"Disease\", \n       fill = \"Weekly Death Count\") +\n  theme_minimal(base_size = 10) +\n  theme(axis.text.x = element_text(hjust = 1, angle = 0),\n        legend.position = \"top\" ) \n\np4 &lt;- ggplot(df_week %&gt;% filter(Disease %in% disease_other1), \n       aes(Year, Disease, fill = `Weekly Death Count`)) +\n  geom_tile() +\n  geom_vline(xintercept = as.Date(\"2020-01-01\"), color = \"red\", linewidth = 1) +  \n  annotate(\"text\", \n           x = as.Date(\"2020-01-30\"), y = 5.8,          \n           label = \"COVID-19 Begins\", \n           color = \"red\", \n           hjust = 0, \n           size = 3, \n           fontface = \"bold\") +\n  scale_fill_viridis_c(option = \"F\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  scale_x_date(\n    breaks = as.Date(paste0(2014:2023, \"-01-01\")),  # ticks at Jan 1 each year\n    labels = date_format(\"%Y\"),\n    limits = as.Date(c(\"2013-12-25\", \"2024-01-05\")),\n    expand = c(0, 0)\n  ) +\n  labs(x = \"Year\", \n       y = \"Disease\", \n       fill = \"Weekly Death Count\") +\n  theme_minimal(base_size = 10) +\n  theme(axis.text.x = element_text(hjust = 1, angle = 0),\n        legend.position = \"top\" ) \n\n\np5 &lt;- ggplot(df_week %&gt;% filter(Disease %in% disease_other2), \n       aes(Year, Disease, fill = `Weekly Death Count`)) +\n  geom_tile() +\n  geom_vline(xintercept = as.Date(\"2020-01-01\"), color = \"red\", linewidth = 1) +  \n  annotate(\"text\", \n           x = as.Date(\"2020-01-30\"), y = 2,          \n           label = \"COVID-19 Begins\", \n           color = \"red\", \n           hjust = 0, \n           size = 3, \n           fontface = \"bold\") +\n  scale_fill_viridis_c(option = \"E\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  scale_x_date(\n    breaks = as.Date(paste0(2014:2023, \"-01-01\")),\n    labels = date_format(\"%Y\"),\n    limits = as.Date(c(\"2013-12-25\", \"2024-01-05\")),\n    expand = c(0, 0)\n  ) +\n  labs(x = \"Year\", \n       y = \"Disease\", \n       fill = \"Weekly Death Count\") +\n  theme_minimal(base_size = 10) +\n  theme(axis.text.x = element_text(hjust = 1, angle = 0),\n        legend.position = \"top\" ) \n\n\nplot_grid(p1, p2, p3, p4, p5,\n          labels = c(\"A. Mortality of Natural Cause vs. All Cause\",\n                     \"B. Mortality Attributable to Respiratory Diseases\", \n                     \"C. Mortality Attributable to COVID-19\", \n                     \"D. Mortality Attributable to Other Diseases\",\n                     \"E. Mortality Attributable to Other Diseases cont.\"),\n          label_x = 0,    \n          label_y = 1,     \n          hjust = 0,        \n          label_size = 10, \n          label_fontface = \"bold\",\n          ncol = 1, \n          align = \"v\",\n          rel_heights = c(1.3, 1.4, 1.4, 1.8, 1.3))\n\nrm(p1, p2, p3, p4, p5)\n\n\n\n\n\nTo further access geographical variability, one disease was selected from each of the five categories in the plot above. Yearly death counts was weighted by corresponding census population estimates and then log-transformed.\nData from 2021 were used for all-cause mortality and mortality due to chronic lower respiratory disease, COVID-19, and heart disease. Data from 2023 were used for mortality due to unclassified symptoms, signs, and abnormal findings.\nThe results revealed disporportionally high mortality in West Virgina across all 5 mortality categories evaluated. Additionally, there is elevated all-cause mortality and mortality due to chronic lower respiratory disease, COVID-19, and heart disease in southeastern side of the United States, particularly in West Virginia, Mississippi, Alabama, Oklahoma, Arkansas, Tennessee, and Kentucky. Mortality due to unclassified symptoms, signs, and abnormal findings was highest in Oklahoma, West Virginia and North Carolina.\n\n\nShow code\n# https://api.census.gov/data/key_signup.html\n# census_api_key(\"14ff972ad235695086e726484ed8f894d6d96212\", install = TRUE)\n\ndf_2021 &lt;- left_join(df_year %&gt;%\n                       select(State, matches(\"2021\")) %&gt;%\n                       rename_with(~ gsub(\" 20(1[4-9]|2[0-3])$\", \"\", .x)), \n                     df_pop %&gt;% select(State, `Population 2021`),\n                     by = \"State\") %&gt;% \n  transmute(state = State,\n            Population = `Population 2021`,\n            across(\n              all_of(disease_order),\n              ~ as.numeric(gsub(\",\", \"\", .x)), \n              .names = \"{col}\"), \n            across(\n              all_of(disease_order),\n              ~ .x / as.numeric(Population), \n              .names = \"Weighted {col}\"))\n\ndf_2023 &lt;- left_join(df_year %&gt;%\n                       select(State, matches(\"2023\")) %&gt;%\n                       rename_with(~ gsub(\" 20(1[4-9]|2[0-3])$\", \"\", .x)), \n                     df_pop %&gt;% select(State, `Population 2023`),\n                     by = \"State\") %&gt;% \n  transmute(state = State,\n            Population = `Population 2023`,\n            across(\n              all_of(disease_order),\n              ~ as.numeric(gsub(\",\", \"\", .x)), \n              .names = \"{col}\"), \n            across(\n              all_of(disease_order),\n              ~ .x / as.numeric(Population), \n              .names = \"Weighted {col}\"))\n\np1 &lt;- plot_usmap(data = df_2021, \n                 regions = \"states\", \n                 values = \"Weighted All Cause\") + \n  scale_fill_viridis_c(option = \"C\",\n                       na.value = \"lightgrey\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  theme(legend.position = 'top') +\n  labs(fill = 'All Cause Mortality (2021)') +\n  guides(\n    fill = guide_colorbar(\n      title.position = \"top\", \n      title.hjust = 0.5,      \n      barwidth = unit(10, \"cm\"),\n      barheight = unit(0.3, \"cm\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\",\n    legend.title = element_text(size = 8, face = \"bold\"),\n    legend.text  = element_text(size = 8)\n  )\n\n\np2 &lt;- plot_usmap(data = df_2021, \n                 regions = \"states\", \n                 values = \"Weighted Chronic lower respiratory diseases\") + \n  scale_fill_viridis_c(option = \"D\",\n                       na.value = \"lightgrey\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  theme(legend.position = 'top') +\n  labs(fill = 'Chronic lower respiratory diseases (2021)') +\n  guides(\n    fill = guide_colorbar(\n      title.position = \"top\", \n      title.hjust = 0.5,      \n      barwidth = unit(10, \"cm\"),\n      barheight = unit(0.3, \"cm\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\",\n    legend.title = element_text(size = 8, face = \"bold\"),\n    legend.text  = element_text(size = 8)\n  )\n\n\np3 &lt;- plot_usmap(data = df_2021, \n                 regions = \"states\", \n                 values = \"Weighted COVID\") + \n  scale_fill_viridis_c(option = \"A\",\n                       na.value = \"lightgrey\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  theme(legend.position = 'top') +\n  labs(fill = 'COVID (2021)') +\n  guides(\n    fill = guide_colorbar(\n      title.position = \"top\", \n      title.hjust = 0.5,      \n      barwidth = unit(10, \"cm\"),\n      barheight = unit(0.3, \"cm\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\",\n    legend.title = element_text(size = 8, face = \"bold\"),\n    legend.text  = element_text(size = 8)\n  )\n\n\np4 &lt;- plot_usmap(data = df_2023, \n                 regions = \"states\", \n                 values = \"Weighted Unclassified symptoms, signs and abnormal findings\") + \n  scale_fill_viridis_c(option = \"F\",\n                       na.value = \"lightgrey\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  theme(legend.position = 'top') +\n  labs(fill = 'Unclassified symptoms, signs and abnormal findings Mortality (2023)') +\n  guides(\n    fill = guide_colorbar(\n      title.position = \"top\", \n      title.hjust = 0.5,      \n      barwidth = unit(10, \"cm\"),\n      barheight = unit(0.3, \"cm\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\",\n    legend.title = element_text(size = 8, face = \"bold\"),\n    legend.text  = element_text(size = 8)\n  )\n\np5 &lt;- plot_usmap(data = df_2021, \n                 regions = \"states\", \n                 values = \"Weighted Diseases of heart\") + \n  scale_fill_viridis_c(option = \"E\",\n                       na.value = \"lightgrey\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  theme(legend.position = 'top') +\n  labs(fill = 'Diseases of heart (2021)') +\n  guides(\n    fill = guide_colorbar(\n      title.position = \"top\", \n      title.hjust = 0.5,      \n      barwidth = unit(10, \"cm\"),\n      barheight = unit(0.3, \"cm\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\",\n    legend.title = element_text(size = 8, face = \"bold\"),\n    legend.text  = element_text(size = 8)\n  )\n\ntop &lt;- plot_grid(\n  p1,\n  labels = c(\"A.\"),\n  label_size = 8, \n  ncol = 1, align = \"hv\")\n\nbottom &lt;- plot_grid(\n  p2,\n  p3,\n  p4,\n  p5,\n  labels = c(\"B.\", \"C.\", \n             \"D.\", \"E\"),\n  label_size = 8, \n  ncol = 2, align = \"hv\")\n\nplot_grid(\n  top,\n  bottom,\n  ncol = 1,\n  align = \"v\",\n  rel_heights = c(1, 2)\n)\n\nrm(df_2021, df_2023, p1, p2, p3, p4, p5, top, bottom)\n\n\n\n\n\n\nHere, I examined mortality trends in the United States between 2014-2023 across multiple causes of death, in terms of geographical and temporal patterns. Overall, mortality for most diseases increased during the COVID-19 period. Mortality from unclassified symptoms, signs, and abnorfmal findings increased sharply in 2023. There is clear seasonal patterns, with mortality lowest in summer and peak in winter. The winter of 2020-2021 showed peaks of the COVID-19 pandemic impact. Geographically, there is disproportionately high mortality in southeastern United States, particularly West Virginia, Alabama, Mississippi, across multiple causes of deaths.\n\n\n\n(1) Lack of individual level data. Unable to investigate how COVID affect different age groups, race, sex, SES, etc. (2) Lack of analysis on flags for other diseases/complications. (3) Limited reporting in 2023.\n\n\n\nI used ChatGPT to (1) Revise regular expression, highlight what’s wrong and why it won’t work, (2) Find a simpler way to do mutate and then select (ChatGPT: transmute), (3) Set column width in kable (ChatGPT: column_spec(1, width = \"10cm\")), (4) Find simpler way to mutate parameters across multiple columns rather than running mutate for a million times (ChatGPT: across(all_of(disease_order), ~ as.numeric(gsub(\",\", \"\", .x)), .names = \"{col}\")), (5) Search how to change text alignment and add caption in qmd, (6) check grammar."
  },
  {
    "objectID": "midterm.html#introduction",
    "href": "midterm.html#introduction",
    "title": "Analysis of the United States",
    "section": "",
    "text": "Background. COVID-19 pandemic took millions of lives and has profound impact on global health. It also influenced mortality from other diseases through comorbidity, disruptions in health care access, and changes in life styles. In this analysis, I compare geotemporal mortlity patterns in the United States before (2014-2019) and during (2020-2023) COVID-19 pandemic to understand how overall and cause-specific death changed across time and region.\nEDA. The primary object of the exploratory data analysis is to check:\n\nDo we have death count for each year and each week?\nWhat is the distribution of weekly death count for each disease and each year? How do those distribution differ before and during COVID-19?\nWhat is the yearly death count / precentage (using Census estimates) for each State?\n\nAnalysis. The primary object of this project is to evaluate:\n\nWhen dividing data to pre COVID-19 (2014 - 2019) and during COVID-19 (2020 - 2023) periods, what’s the percent change in mean weekly death count for each disease?\nIs there temporal patterns for disease-specific death counts between 2014 - 2023? How do these patterns align with COVID-19 death pattern? Which month has the lowest/highest of weekly death? How do monthly death counts vary across each year?\nWhich State has the highest disease-specific death (weighted by census estimation of population)? Is there any region disproportionately affected?"
  },
  {
    "objectID": "midterm.html#data-preparation",
    "href": "midterm.html#data-preparation",
    "title": "Analysis of the United States",
    "section": "",
    "text": "Weekly count of death by state and select causes in 2014-2019 vs 2020-2023 were exported from CDC. US Census Estimates were pulled from usmap package.\nThe data sets for 2020-2023 includes additional columns, COVID-19 (U071, Multiple Cause of Death) and COVID-19 (U071, Underlying Cause of Death), due to COVID19 pandemic. Additionally, deaths caused by influenza and pneumonia category changed from J10-J18 (2014-2019) to J09-J18 (2020-2023).\nHere, I converted count of death columns in both data sets from chr to numeric and Week Ending Date column in 2014-2019 data set from chr to IDate. Next, I manually added columns that were missing in either data set (i.e., present in one data set but not the other) and set their values to NA. Then, I create a new column named Dataset Type to distinguish data from 2015-2019 and 2020-2023. Finally, I combined two data sets into one. Additionally, I created a new variable named Influenza and pneumonia that combines Influenza and pneumonia (J10-J18) from 2014-2019 and Influenza and pneumonia (J09-J18) from 2020-2023.\n\n\nShow code\nidir      &lt;- \"/Users/xinranwang/Documents/Course/25Fall/PM566/Data\"\nfilename1 &lt;- \"Weekly_Counts_of_Deaths_by_State_and_Select_Causes,_2014-2019_20251015.csv\"\nfilename2 &lt;- \"Weekly_Provisional_Counts_of_Deaths_by_State_and_Select_Causes,_2020-2023_20251015.csv\"\n\n\n\n\nShow code\ndf_2014_2019 &lt;- fread(paste0(idir, \"/\", filename1))\ndf_2020_2023 &lt;- fread(paste0(idir, \"/\", filename2))\n\n# setequal(names(df_2014_2019), names(df_2020_2023))  # Check if colnames are same: No\n# setdiff(names(df_2014_2019), names(df_2020_2023))   # Columns in 2014-19 but not 2020-23\n# setdiff(names(df_2020_2023), names(df_2014_2019))   # Columns in 2020-23 but not 2014-19\n\ndf_2014_2019 &lt;- df_2014_2019 %&gt;% \n  mutate(across(5:17, ~ as.numeric(gsub(\",\", \"\", .x))),\n         `Dataset Type`                               = \"2014-2019\", \n         `Influenza and pneumonia (J09-J18)`          = NA,\n         `Data As Of`                                 = NA, \n         `COVID-19 (U071, Multiple Cause of Death)`   = NA, \n         `COVID-19 (U071, Underlying Cause of Death)` = NA, \n         `flag_cov19mcod`                             = NA, \n         `flag_cov19ucod`                             = NA,\n         `Week Ending Date` = as.IDate(`Week Ending Date`, format = \"%m/%d/%Y\")) %&gt;%\n  rename(`All Cause` = `All  Cause`) \n\ndf_2020_2023 &lt;- df_2020_2023 %&gt;% \n  mutate(across(6:20, ~ as.numeric(gsub(\",\", \"\", .x))),\n         `Dataset Type`                               = \"2020-2023\", \n         `Influenza and pneumonia (J10-J18)`          = NA)\n\n# setequal(names(df_2014_2019), names(df_2020_2023))  # Check if colnames are same: Yes\n\ndf &lt;- bind_rows(df_2014_2019, df_2020_2023)\n\ndf &lt;- df %&gt;%\n    mutate(`Influenza and pneumonia` = \n             coalesce(`Influenza and pneumonia (J09-J18)`,\n                      `Influenza and pneumonia (J10-J18)`),\n           `COVID` = rowSums(across(c(\n             `COVID-19 (U071, Multiple Cause of Death)`, \n             `COVID-19 (U071, Underlying Cause of Death)`))))\n\nrm(df_2014_2019, df_2020_2023, filename1, filename2)\n\ndisease_order &lt;- c(\n  \"All Cause\",\n  \"Natural Cause\",\n  \"Unclassified symptoms, signs and abnormal findings\",\n  \"Septicemia\",\n  \"Nephritis, nephrotic syndrome and nephrosis\",\n  \"Diabetes mellitus\",\n  \"Alzheimer disease\",\n  \"Cerebrovascular diseases\",\n  \"Malignant neoplasms\",\n  \"Diseases of heart\",\n  \"Other diseases of respiratory system\",\n  \"Influenza and pneumonia\",\n  \"Chronic lower respiratory diseases\",\n  \"COVID-19 (Multiple Cause of Death)\",\n  \"COVID-19 (Underlying Cause of Death)\",\n  \"COVID\"\n  )\n\nyears_palette &lt;- viridisLite::plasma(10)\nyears &lt;- 2014:2023\nnames(years_palette) &lt;- years\n\ndf &lt;- df %&gt;% \n  rename(\n    Septicemia                 = `Septicemia (A40-A41)`,\n    `Malignant neoplasms`      = `Malignant neoplasms (C00-C97)`,\n    `Alzheimer disease`        = `Alzheimer disease (G30)`,\n    `Diabetes mellitus`        = `Diabetes mellitus (E10-E14)`,\n    `Diseases of heart`        = `Diseases of heart (I00-I09,I11,I13,I20-I51)`,\n    `Cerebrovascular diseases` = `Cerebrovascular diseases (I60-I69)`,\n    `Nephritis, nephrotic syndrome and nephrosis` = \n      `Nephritis, nephrotic syndrome and nephrosis (N00-N07,N17-N19,N25-N27)`,\n    `Unclassified symptoms, signs and abnormal findings` = \n      `Symptoms, signs and abnormal clinical and laboratory findings, not elsewhere classified (R00-R99)`,\n    `Chronic lower respiratory diseases` = \n      `Chronic lower respiratory diseases (J40-J47)`,\n    `Other diseases of respiratory system` = \n      `Other diseases of respiratory system (J00-J06,J30-J39,J67,J70-J98)`,\n    `COVID-19 (Multiple Cause of Death)`   = `COVID-19 (U071, Multiple Cause of Death)`,\n    `COVID-19 (Underlying Cause of Death)` = `COVID-19 (U071, Underlying Cause of Death)`\n  ) %&gt;%\n  select(c(\"Jurisdiction of Occurrence\",\n           \"MMWR Year\",\n           \"MMWR Week\",\n           \"Week Ending Date\"),\n         any_of(disease_order), everything())"
  },
  {
    "objectID": "midterm.html#exploratory-data-analysis",
    "href": "midterm.html#exploratory-data-analysis",
    "title": "Analysis of the United States",
    "section": "",
    "text": "After combining and cleaning dataset from 2014-2019 and 2020-2023, the final data set contains 27,378 rows and 38 columns. The data include location information (USA and individual states), temporal patterns (year and week start date), weekly death count by various disease, and indicator flags for relevant diseases.\nDeath counts are categorized as total (all-cause), natural cause, and 12 specific diseases. COVID-19 is further divided into multiple cause and underlying cause of deaths.\n\n\nShow code\n# Skim everything except IDate column:\nskim(df %&gt;% select(-`Week Ending Date`))\n\n# For IDate formatted column:\nprint(paste0(\"Number of rows of Week Ending Date: \", length(df$`Week Ending Date`)))\nprint(paste0(\"Completeness: \", \n             length(!is.na(df$`Week Ending Date`)) / length(df$`Week Ending Date`)))\nstr(df$`Week Ending Date`)\nsummary(df$`Week Ending Date`)\n\n# Head and Tail\nhead(df, 5)\ntail(df, 5)\n\n\n\n\n\nI began by checking number of weeks reported per year. All COVID-19 related categories shared the same number of weeks, as did all non-COVID diseases (although the the two groups differs from each other). Thus, I summarized the data by collapsing them into 2 rows: number of weeks for COVID and for non-COVID diseases.\n\n\nShow code\ndf_count_week &lt;- df %&gt;%\n  filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n  rename(Year = `MMWR Year`, Week = `MMWR Week`) %&gt;%\n  transmute(\n    Year, Week,\n    across(all_of(disease_order), ~ as.numeric(gsub(\",\", \"\", .x)))\n  ) %&gt;%\n  arrange(Year, Week) %&gt;%\n  group_by(Year) %&gt;%\n  summarise(across(all_of(disease_order), ~ sum(!is.na(.x)))) %&gt;%\n  ungroup() %&gt;%\n  pivot_longer(-Year, names_to = \"Disease\", values_to = \"Weeks\") %&gt;%\n  pivot_wider(names_from = Year, values_from = Weeks)\n\ndf_count_week_collapsed &lt;- df_count_week %&gt;%\n  group_by(across(-Disease)) %&gt;%   \n  summarise(Diseases = paste(Disease, collapse = \", \")) %&gt;%\n  ungroup() %&gt;%\n  select(Diseases, everything())\n\nkable(df_count_week_collapsed,\n      align = c(\"l\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\"),\n      caption = \"Table 1. Number of Weeks Recorded in United States per Year\") %&gt;%\n  kable_styling(full_width = FALSE) %&gt;%\n  column_spec(1, width = \"10cm\") \n\nrm(df_count_week, df_count_week_collapsed)\n\n\n\n\n\nThen, I plotted the distribution of weekly death count for each disease from 2014 to 2023. Most diseases show a clear rightward shift from pre COVID-19 period to during COVID-19 period, except influenza and phenomena and chronic lower respiratory disease, which is likely due to public health measures implemented during COVID (such as mask wearing, physical distancing, etc). There is a significant decrease in weekly death count for COVID in 2023 (as compared to 2020 - 2022), likely due to reduced reporting (See Table 2).\n\n\nShow code\nplot_disease_distribution &lt;- function(disease_col, bins = 30, show_legend = FALSE) {\n  if (grepl(\"COVID\", disease_col, ignore.case = TRUE)) {\n    dat &lt;- df %&gt;% filter(`MMWR Year` &gt;= 2020)\n  } else {\n    dat &lt;- df\n  }\n  \n  dat &lt;- dat %&gt;%\n    rename(Year = `MMWR Year`) %&gt;%\n    filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n    transmute(\n      Year = factor(Year),  \n      Count = as.numeric(gsub(\",\", \"\", .data[[disease_col]]))\n    )\n\n  ggplot(dat, aes(x = Count, fill = Year)) +\n    geom_histogram(bins = bins, color = \"white\", alpha = 0.7, position = \"identity\") + \n    labs(title = disease_col, x = \"Weekly Death Count\", y = \"Count\") +\n    scale_x_continuous(labels = scales::comma) +\n    scale_fill_manual(values = years_palette, drop = T) +\n    theme_minimal(base_size = 8) +\n    theme(\n      plot.title  = element_text(size = 8, face = \"bold\"),\n      axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n      axis.text.y = element_text(size = 8),\n      legend.position = if (show_legend) \"bottom\" else \"none\"\n    )\n}\n\nplot_list &lt;- lapply(disease_order, plot_disease_distribution, bins = 30)\nmain_plot &lt;- plot_grid(\n  plotlist = plot_list,\n  ncol=4\n  )\n\nplot_for_legend &lt;- plot_disease_distribution(disease_order[1], 30, show_legend = T) +\n  ggplot2::theme(legend.position = \"bottom\")\nlegend &lt;- cowplot::ggdraw(get_plot_component(plot_for_legend, 'guide-box-bottom', return_all = TRUE))\n\nplot_grid(\n  plotlist = c(main_plot, legend),\n  ncol=1,\n  label_size = 8,                           \n  label_fontface = \"bold\", \n  rel_heights = c(1, 0.1)\n)\n\nrm(plot_disease_distribution, plot_list, main_plot, plot_for_legend, legend)\n\n\n\n\n\nAdditionally, I evaluated COVID-19 death count by State for all diseases. West Virginia, Alabama, Arizona, Mississippi, Tennessee were among the most severely affected States in 2021, each reporting COVID-19 mortality exceeding 0.37% of their population.\n\n\nShow code\ndf_year &lt;- df %&gt;%\n  filter(`Jurisdiction of Occurrence` != \"United States\") %&gt;%\n  rename(\n    State = `Jurisdiction of Occurrence`,\n    Year  = `MMWR Year`,\n    Week  = `MMWR Week`\n  ) %&gt;%\n  transmute(\n    State,\n    Year,\n    across(all_of(disease_order), ~ as.numeric(gsub(\",\", \"\", .x)))\n  ) %&gt;%\n  group_by(State, Year) %&gt;%\n  summarise(across(all_of(disease_order), sum, na.rm = TRUE)) %&gt;%\n  ungroup %&gt;%\n  pivot_longer(all_of(disease_order), \n               names_to = \"Disease\", \n               values_to = \"Count\") %&gt;%\n  pivot_wider(\n    names_from  = c(Disease, Year),\n    values_from = Count,\n    names_sep   = \" \"\n  ) %&gt;%\n  arrange(State)\n\n#\ndf_pop &lt;- map_dfr(\n  2020:2023,\n  ~ get_estimates(geography = \"state\", product = \"population\", year = .x) %&gt;%\n    filter(variable == \"POPESTIMATE\") %&gt;%\n    transmute(State = NAME, Year = .x, Population = value)\n  )\n  \ndf_pop &lt;- df_pop %&gt;%\n  tidyr::pivot_wider(names_from = Year, values_from = Population,\n                     names_prefix = \"Population \")\n\nkable(left_join(\n  df_year %&gt;% \n    select(State, matches(\"COVID 202\")) %&gt;%\n    rename_with(~ gsub(\"COVID \", \"\", .x)), \n  df_pop, \n  by = \"State\") %&gt;%\n    mutate(\n      `2020 Count (%)` = paste0(format(`2020`, big.mark=\",\"), \" (\", \n                      format(round((`2020` / `Population 2020`) * 100, 2), \n                             big.mark=\",\"), \"%)\"), \n      `2021 Count (%)` = paste0(format(`2021`, big.mark=\",\"), \" (\", \n                      format(round((`2021` / `Population 2021`) * 100, 2), \n                             big.mark=\",\"), \"%)\"),\n      `2022 Count (%)` = paste0(format(`2022`, big.mark=\",\"), \" (\", \n                      format(round((`2022` / `Population 2022`) * 100, 2), \n                             big.mark=\",\"), \"%)\"), \n      `2023 Count (%)` = paste0(format(`2023`, big.mark=\",\"), \" (\", \n                      format(round((`2023` / `Population 2023`) * 100, 2), \n                             big.mark=\",\"), \"%)\")) %&gt;%\n    select(c(State, `2020 Count (%)`, `2021 Count (%)`, `2022 Count (%)`, `2023 Count (%)`)),\n  align = c(\"l\", \"c\", \"c\", \"c\"), \n  caption = \"Table 2. COVID Death by State (2020-2023)\")"
  },
  {
    "objectID": "midterm.html#preliminary-results",
    "href": "midterm.html#preliminary-results",
    "title": "Analysis of the United States",
    "section": "",
    "text": "First, I evaluate the trend of weekly all cause mortality from 2014 to 2023 in the United States. Overall, summer months (June - August) tends to have fewest death, whereas winter (December - January) tends to have the highest number of deaths. December 2020 - January 2021 were the peak periods of COVID-19 impact, with weekly deaths reaching 87,033 in December and 87,415 in January.\n\n\nShow code\nkable(df %&gt;%\n        filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n        mutate(Month = month(as.Date(`Week Ending Date`) - 3, label = TRUE, abbr = TRUE)) %&gt;%\n        rename(Year = `MMWR Year`) %&gt;%\n        group_by(Year) %&gt;%\n        summarize(\n          `Min (Mo.)` = paste0(format(round(min(`All Cause`, na.rm = TRUE), 0), \n                                      big.mark=\",\"), \n                               \" (\", Month[which.min(`All Cause`)], \".)\"),\n          `1st quartile` = format(round(quantile(`All Cause`, 0.25, na.rm = TRUE),0), \n                                  big.mark=\",\"),\n          `Median`       = format(round(quantile(`All Cause`, 0.5,  na.rm = TRUE), 0), \n                                  big.mark=\",\"),\n          `Mean`         = format(round(mean(`All Cause`, na.rm = TRUE),0), big.mark=\",\"),\n          `3rd quartile` = format(round(quantile(`All Cause`, 0.75, na.rm = TRUE),0), \n                                  big.mark=\",\"),\n          `Max (Mo.)`    = paste0(format(round(max(`All Cause`, na.rm = TRUE), 0), \n                                         big.mark=\",\"),\n                                  \" (\", Month[which.max(`All Cause`)], \".)\"),\n          `Mean (SD)`    = paste0(Mean, \" (\", round(sd(`All Cause`,na.rm = TRUE), 0), \")\")) %&gt;%\n        select(Year, `Min (Mo.)`, `1st quartile`, `Mean (SD)`, everything()),\n  caption = \"Table 3. Summary Statistics of Weekly All Cause Death (2014-2023) in United States\",\n  align = \"c\")\n\n\n\n\n\nHere, I accessed mean weekly death for each disease before (2014-2019) and during (2020-2023) COVID-19 pandemic in the United States. The corresponding percentage change was also calculated.\nBoth all causes of death and nature cause of death increased approximately 19%. Most diseases showed an overall percentage increase (greater than population growth rate of 0.52%) in deaths. Specifically, there was substantial increase in mortality from unclassified symptoms, signs and abnormal findings, diabetes mellitus, other diseases of respiratory system, cerebrovascular diseases (36.58%, 22.29%, 15.7%, 13.09% increase, respectively). Mortality due Influenza and chronic lower respiratory disease decreased by 14.58% and 5.7%, likely due to death being re-classified as COVID-19 related deaths (either as multiple or underlying causes).\n\n\nShow code\nkable(df %&gt;%\n        dplyr::filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n        group_by(`Dataset Type`) %&gt;%\n        summarise(\n          across(all_of(disease_order), \n                 ~ round(mean(as.numeric(.x), na.rm = TRUE),2), \n                 .names = \"{col}\")) %&gt;%\n        ungroup() %&gt;%\n        pivot_longer(-`Dataset Type`, \n                     names_to = \"Variable\", \n                     values_to = \"Mean\") %&gt;%\n        pivot_wider(names_from = `Dataset Type`, \n                    values_from = Mean) %&gt;%\n        mutate(`% Change` = \n                 paste0(\n                   round(((`2020-2023` - `2014-2019`) / `2014-2019`) * 100, 2), \"%\"),\n               `2014-2019` = format(round(`2014-2019`, 0), big.mark = \",\"),\n               `2020-2023` = format(round(`2020-2023`, 0), big.mark = \",\")),\n      caption = \"Table 4. Summary Statistics of Mean Weekly Mortality (Before vs During COVID-19) in United States\",\n      align = c(\"l\", \"c\", \"c\", \"c\")) %&gt;%\n  kable_styling(full_width = FALSE) %&gt;%\n  column_spec(1, width = \"10cm\")\n\n\n\n\n\nNext, I examined mean weekly death for each disease per year in the United States. Note that mean weekly death were used instead of annual death count because only 37 weeks was recorded in 2023.\nI observed similar trends all-cause and natural-cause mortality, as well as death due to nephritis, nephrotic syndrome and nephrosis, diabetes mellitus, cerebrovascular diseases, malignant neoplass, diseases of the heart. Mortality showed slightly upward trend during pre COVID-19 years (2014-2019), followed by a sharp increase from 2019-2020. The upward trend continued at a slower rate between 2020-2021 and declined from 2021-2023. However, mortality levels remained higher than those in 2019, consistent with the pre COVID-19 increasing trend.\nThere is similar pattern for other disease with respiratory system, except that mortality did not decline after 2021. Septicemia exhibited a sharp decline in 2019, followed by a steady rise from 2020-2022, peaking in 2022, which aligns with the context of COVID-19 as Septicemia can result from an excessive immune response. Mortality due to Alzheimer’s disease showed a substantial increase in 2020. Deaths due to influenza and pneumonia and chronic lower respiratory diseases declined, likely due to public health measures. Deaths attributable to unclassified symptoms, signs and abnormal findings rose sharply in 2023.\nPatterns by year\n\n\nShow code\n################## Average Weekly Death per Year\nplot_disease_yearly &lt;- function(disease_col, line_col = \"steelblue\") {\n  \n  dat &lt;- df %&gt;%\n    filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n    transmute(\n      `MMWR Year`,\n      `Week Ending Date`,\n      Count = as.numeric(gsub(\",\", \"\", .data[[disease_col]])) \n    ) %&gt;%\n    group_by(`MMWR Year`) %&gt;%\n    summarise(\n      Mean  = mean(Count, na.rm = TRUE),\n      SD    = sd(Count,   na.rm = TRUE),\n      SE    = SD / sqrt(sum(!is.na(Count)))\n    ) %&gt;%\n    ungroup() %&gt;%\n    rename(Year = `MMWR Year`)\n    \n  ggplot(dat, aes(x = Year, y = Mean)) +\n    geom_line(linewidth = 1, color = line_col) +\n    geom_point(size = 2, color = line_col) +\n    geom_errorbar(aes(ymin = Mean - SE, ymax = Mean + SE),\n                  width = 0.2, color = line_col) +\n    labs(\n      title = disease_col,\n      x = \"Year\",\n      y = \"Avg Weekly Death Count\"\n    ) +\n    scale_x_continuous(breaks = 2014:2023, limits = c(2014, 2023)) +\n    theme_minimal(base_size = 8) +\n    theme(plot.title  = element_text(size = 8, face = \"bold\"),\n          axis.text.x = element_text(hjust = 1, angle = 45)) \n}\n\nplots_list &lt;- map(disease_order, plot_disease_yearly)\n\nplot_grid(\n  plotlist = plots_list,\n  ncol = 4,\n  align = \"hv\",\n  labels = paste0(LETTERS[seq_along(plots_list)], \".\"),\n  label_x = 0, hjust = 0, label_size = 8\n)\n\nrm(plot_disease_yearly, plots_list)\n\n\nPatterns by Month and Year\nSince Table 3 shows that the minimum weekly death count typically occur during summer and the maximized during winter, I further examined seasonal pattern by plotting monthly death counts by month and year.\nThe results showed U-shaped trend in monthly deaths, with lowest in summer and highest in winter, for all death count categories except malignant neoplasms. Additionally, the death count for 2020-2023 is generally higher than than those for 2014-2019, consistent with the findings in Table 4.\n\n\nShow code\n################## Average Monthly Death per Year\nplot_disease_monthly &lt;- function(disease_col, show_legend = FALSE, year_start, year_end) {\n  \n  dat &lt;- df %&gt;%\n    filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n    transmute(\n      `MMWR Year`,\n      `Week Ending Date`,\n      Month = month(as.Date(`Week Ending Date`)),\n      Year = as.character( `MMWR Year`),\n      #Weekly_Count = as.numeric(gsub(\",\", \"\", `All Cause`))\n      Weekly_Count = as.numeric(gsub(\",\", \"\", .data[[disease_col]]))\n    ) %&gt;%\n    group_by(Year, Month) %&gt;%\n    summarize(Monthly_Count = sum(Weekly_Count, na.rm=T)) %&gt;%\n    ungroup()\n  \n  ymax &lt;- max(dat$Monthly_Count, na.rm=T)\n  ymin &lt;- min(dat$Monthly_Count, na.rm=T) \n  \n  ymax_2014_2019 &lt;- (dat %&gt;%\n    filter(Year &gt;= 2014, Year &lt;= 2019) %&gt;%\n    summarise(ymax = max(Monthly_Count, na.rm = TRUE)))$ymax\n  ymin_2014_2019 &lt;- (dat %&gt;%\n    filter(Year &gt;= 2014, Year &lt;= 2019) %&gt;%\n    summarise(ymin = min(Monthly_Count, na.rm = TRUE)))$ymin\n  \n  dat &lt;- dat %&gt;% filter(Year &gt;= year_start & Year &lt;= year_end) \n    \n  ggplot(dat, aes(x = Month, y = Monthly_Count, color = Year, group = Year)) +\n    geom_hline(yintercept = ymax_2014_2019, linewidth = 0.5, color = \"grey\") +\n    geom_hline(yintercept = ymin_2014_2019, linewidth = 0.5, color = \"grey\") +\n    annotate(\"rect\", xmin = -Inf, xmax = Inf, ymin = ymin_2014_2019, ymax = ymax_2014_2019,\n           alpha = 0.2, fill = \"lightgrey\") +\n    geom_line(linewidth = 0.5, alpha = 0.7) +\n    geom_point(size = 1) +\n    labs(\n      title = disease_col,\n      subtitle = paste0(year_start, \"-\", year_end),\n      x = \"Month\",\n      y = \"Monthly Death Count\"\n    ) +\n    scale_color_manual(values = years_palette, drop = T) +\n    scale_x_continuous(breaks = 1:12, limits = c(1, 12)) +\n    scale_y_continuous(labels = comma, limits = c(ymin, ymax)) +\n    theme_minimal(base_size = 8) +\n    theme(\n      plot.title  = element_text(size = 8, face = \"bold\"),\n      axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n      axis.text.y = element_text(size = 8),\n      legend.position = if (show_legend) \"bottom\" else \"none\"\n    )\n}\n\n#\nplots_list_2014_2019_1 &lt;- map(disease_order[1:8], ~ plot_disease_monthly(.x, FALSE, 2014, 2019))\nmain_plot_2014_2019_1 &lt;- plot_grid(\n  plotlist = plots_list_2014_2019_1,\n  ncol = 1,\n  align = \"hv\",\n  labels = c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\"),\n  label_x = 0, hjust = 0, label_size = 8\n)\n\nplots_list_2014_2019_2 &lt;- map(disease_order[9:16], ~ plot_disease_monthly(.x, FALSE, 2014, 2019))\nmain_plot_2014_2019_2 &lt;- plot_grid(\n  plotlist = plots_list_2014_2019_2,\n  ncol = 1,\n  align = \"hv\",\n  labels = c(\"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\"),\n  label_x = 0, hjust = 0, label_size = 8\n)\n\n#\nplots_list_2020_2023_1 &lt;- map(disease_order[1:8], ~ plot_disease_monthly(.x, FALSE, 2020, 2023))\nmain_plot_2020_2023_1 &lt;- plot_grid(\n  plotlist = plots_list_2020_2023_1,\n  ncol = 1,\n  align = \"hv\",\n  label_x = 0, hjust = 0, label_size = 8\n)\n\nplots_list_2020_2023_2 &lt;- map(disease_order[9:16], ~ plot_disease_monthly(.x, FALSE, 2020, 2023))\nmain_plot_2020_2023_2 &lt;- plot_grid(\n  plotlist = plots_list_2020_2023_2,\n  ncol = 1,\n  align = \"hv\",\n  label_x = 0, hjust = 0, label_size = 8\n)\n\n#\nplot_for_legend &lt;- plot_disease_monthly(disease_order[1], TRUE, 2014, 2023) +\n  ggplot2::theme(legend.position = \"bottom\")\nlegend &lt;- cowplot::ggdraw(get_plot_component(plot_for_legend, 'guide-box-bottom', return_all = TRUE))\n\n#\nmerged_plot &lt;- plot_grid(\n  plotlist = c(main_plot_2014_2019_1, main_plot_2020_2023_1, \n               main_plot_2014_2019_2, main_plot_2020_2023_2),\n  ncol=4,\n  label_size = 8,                           \n  label_fontface = \"bold\"\n)\n\n#\nplot_grid(\n  plotlist = c(merged_plot, legend),\n  ncol=1,\n  label_size = 8,                           \n  label_fontface = \"bold\", \n  rel_heights = c(1, 0.1)\n)\n\nrm(plot_disease_monthly, dat,\n   ymin, ymax, ymin_2014_2019, ymax_2014_2019,\n   plots_list_2014_2019_1, plots_list_2014_2019_2, \n   main_plot_2014_2019_1, main_plot_2014_2019_2,\n   plots_list_2020_2023_1, plots_list_2020_2023_2,\n   main_plot_2020_2023_1, main_plot_2020_2023_2,\n   plot_for_legend, merged_plot)\n\n\n\n\n\nHere, I evaluated mortality by disease and by week of the year in the United States. Weekly mortality counts was divided by five categories: (1) mortality of nature cause or all causes, (2) mortality attributable to respiratory diseases, (3) mortality attributable to COVID-19, (4) mortality attributable to other diseases with lower mortality counts, and (5) mortality attributable to other diseases with higher mortality counts. The categorization was applied as mortality differ across various causes of death.\nThere was a clear overlapping temporal pattern across most diseases in the heat map, with most deaths during in the winter, except for mortality due to (1) malignant neoplasms and (2) unclassified symptoms, signs, and abnormal findings. It is concerning that mortality due to unclassified symptoms, signs, and abnormal findings, increased dramatically in 2023 to over 3000. Signals for all cause mortality, natural cause mortality, and mortality from cerebrovascular disease and heart disease intensified during COVID-19 period (brighter color), while mortality from diabetes mellitus persisted for a longer duration during COVID-19 (wider peak signal).\n\n\nShow code\ndf_week &lt;- df %&gt;%\n  filter(`Jurisdiction of Occurrence` == \"United States\") %&gt;%\n  select(`Week Ending Date`, all_of(disease_order)) %&gt;%  \n  pivot_longer(\n    cols = all_of(disease_order),\n    names_to  = \"Disease\",\n    values_to = \"Weekly Death Count\"\n  ) %&gt;%\n  rename(Year = `Week Ending Date`)\n\nmortality &lt;- c(\n  \"All Cause\",\n  \"Natural Cause\"\n  )\n\ndisease_respiratory &lt;- c(\n  \"Other diseases of respiratory system\",\n  \"Influenza and pneumonia\",\n  \"Chronic lower respiratory diseases\"\n  )\n\ndisease_covid &lt;- c(\n  \"COVID-19 (Multiple Cause of Death)\",\n  \"COVID-19 (Underlying Cause of Death)\",\n  \"COVID\"\n  )\n\ndisease_other1 &lt;- c(\n  \"Septicemia\",\n  \"Diabetes mellitus\",\n  \"Alzheimer disease\",\n  \"Cerebrovascular diseases\",\n  \"Nephritis, nephrotic syndrome and nephrosis\",\n  \"Unclassified symptoms, signs and abnormal findings\"\n  )\n\ndisease_other2 &lt;- c(\n  \"Malignant neoplasms\",\n  \"Diseases of heart\"\n  )\n\np1 &lt;- ggplot(df_week %&gt;% filter(Disease %in% mortality), \n       aes(Year, Disease, fill = `Weekly Death Count`)) +\n  geom_tile() +\n  geom_vline(xintercept = as.Date(\"2020-01-30\"), color = \"red\", linewidth = 1) +  \n  annotate(\"text\", \n           x = as.Date(\"2020-02-28\"), y = 2,          \n           label = \"COVID-19 Begins\", \n           color = \"red\", \n           hjust = 0, \n           size = 3, \n           fontface = \"bold\") +\n  scale_fill_viridis_c(option = \"C\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  scale_x_date(\n    breaks = as.Date(paste0(2014:2023, \"-01-01\")), \n    labels = date_format(\"%Y\"),\n    limits = as.Date(c(\"2013-12-25\", \"2024-01-05\")),\n    expand = c(0, 0)\n  ) +\n  labs(x = \"Year\", \n       y = \"Disease\", \n       fill = \"Weekly Death Count\") +\n  theme_minimal(base_size = 10) +\n  theme(axis.text.x = element_text(hjust = 1, angle = 0),\n        legend.position = \"top\" ) \n\np2 &lt;- ggplot(df_week %&gt;% \n               filter(Disease %in% disease_respiratory),\n             aes(Year, Disease, fill = `Weekly Death Count`)) +\n  geom_tile() +\n  geom_vline(xintercept = as.Date(\"2020-01-01\"), color = \"red\", linewidth = 1) +  \n  annotate(\"text\", \n           x = as.Date(\"2020-01-30\"), y = 2.8,          \n           label = \"COVID-19 Begins\", \n           color = \"red\", \n           hjust = 0, \n           size = 3, \n           fontface = \"bold\") +\n  scale_fill_viridis_c(option = \"D\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  scale_x_date(\n    breaks = as.Date(paste0(2014:2023, \"-01-01\")),  # ticks at Jan 1 each year\n    labels = date_format(\"%Y\"),\n    limits = as.Date(c(\"2013-12-25\", \"2024-01-05\")),\n    expand = c(0, 0)\n  ) +\n  labs(x = \"Year\", \n       y = \"Disease\", \n       fill = \"Weekly Death Count\") +\n  theme_minimal(base_size = 10) +\n  theme(axis.text.x = element_text(hjust = 1, angle = 0),\n        legend.position = \"top\" ) \n\np3 &lt;- ggplot(df_week %&gt;% filter(Disease %in% disease_covid), \n       aes(Year, Disease, fill = `Weekly Death Count`)) +\n  geom_tile() +\n  geom_vline(xintercept = as.Date(\"2020-01-01\"), color = \"red\", linewidth = 1) +  \n  annotate(\"text\", \n           x = as.Date(\"2020-02-01\"), y = 2.8,          \n           label = \"COVID-19 Begins\", \n           color = \"red\", \n           hjust = 0, \n           size = 3, \n           fontface = \"bold\") +\n  scale_fill_viridis_c(option = \"A\",\n                       na.value = \"lightgrey\",   \n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  scale_x_date(\n    breaks = as.Date(paste0(2020:2023, \"-01-01\")),  # ticks at Jan 1 each year\n    labels = date_format(\"%Y\"),\n    limits = as.Date(c(\"2013-12-25\", \"2024-01-05\")),\n    expand = c(0, 0)\n  ) +\n  labs(x = \"Year\", \n       y = \"Disease\", \n       fill = \"Weekly Death Count\") +\n  theme_minimal(base_size = 10) +\n  theme(axis.text.x = element_text(hjust = 1, angle = 0),\n        legend.position = \"top\" ) \n\np4 &lt;- ggplot(df_week %&gt;% filter(Disease %in% disease_other1), \n       aes(Year, Disease, fill = `Weekly Death Count`)) +\n  geom_tile() +\n  geom_vline(xintercept = as.Date(\"2020-01-01\"), color = \"red\", linewidth = 1) +  \n  annotate(\"text\", \n           x = as.Date(\"2020-01-30\"), y = 5.8,          \n           label = \"COVID-19 Begins\", \n           color = \"red\", \n           hjust = 0, \n           size = 3, \n           fontface = \"bold\") +\n  scale_fill_viridis_c(option = \"F\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  scale_x_date(\n    breaks = as.Date(paste0(2014:2023, \"-01-01\")),  # ticks at Jan 1 each year\n    labels = date_format(\"%Y\"),\n    limits = as.Date(c(\"2013-12-25\", \"2024-01-05\")),\n    expand = c(0, 0)\n  ) +\n  labs(x = \"Year\", \n       y = \"Disease\", \n       fill = \"Weekly Death Count\") +\n  theme_minimal(base_size = 10) +\n  theme(axis.text.x = element_text(hjust = 1, angle = 0),\n        legend.position = \"top\" ) \n\n\np5 &lt;- ggplot(df_week %&gt;% filter(Disease %in% disease_other2), \n       aes(Year, Disease, fill = `Weekly Death Count`)) +\n  geom_tile() +\n  geom_vline(xintercept = as.Date(\"2020-01-01\"), color = \"red\", linewidth = 1) +  \n  annotate(\"text\", \n           x = as.Date(\"2020-01-30\"), y = 2,          \n           label = \"COVID-19 Begins\", \n           color = \"red\", \n           hjust = 0, \n           size = 3, \n           fontface = \"bold\") +\n  scale_fill_viridis_c(option = \"E\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  scale_x_date(\n    breaks = as.Date(paste0(2014:2023, \"-01-01\")),\n    labels = date_format(\"%Y\"),\n    limits = as.Date(c(\"2013-12-25\", \"2024-01-05\")),\n    expand = c(0, 0)\n  ) +\n  labs(x = \"Year\", \n       y = \"Disease\", \n       fill = \"Weekly Death Count\") +\n  theme_minimal(base_size = 10) +\n  theme(axis.text.x = element_text(hjust = 1, angle = 0),\n        legend.position = \"top\" ) \n\n\nplot_grid(p1, p2, p3, p4, p5,\n          labels = c(\"A. Mortality of Natural Cause vs. All Cause\",\n                     \"B. Mortality Attributable to Respiratory Diseases\", \n                     \"C. Mortality Attributable to COVID-19\", \n                     \"D. Mortality Attributable to Other Diseases\",\n                     \"E. Mortality Attributable to Other Diseases cont.\"),\n          label_x = 0,    \n          label_y = 1,     \n          hjust = 0,        \n          label_size = 10, \n          label_fontface = \"bold\",\n          ncol = 1, \n          align = \"v\",\n          rel_heights = c(1.3, 1.4, 1.4, 1.8, 1.3))\n\nrm(p1, p2, p3, p4, p5)\n\n\n\n\n\nTo further access geographical variability, one disease was selected from each of the five categories in the plot above. Yearly death counts was weighted by corresponding census population estimates and then log-transformed.\nData from 2021 were used for all-cause mortality and mortality due to chronic lower respiratory disease, COVID-19, and heart disease. Data from 2023 were used for mortality due to unclassified symptoms, signs, and abnormal findings.\nThe results revealed disporportionally high mortality in West Virgina across all 5 mortality categories evaluated. Additionally, there is elevated all-cause mortality and mortality due to chronic lower respiratory disease, COVID-19, and heart disease in southeastern side of the United States, particularly in West Virginia, Mississippi, Alabama, Oklahoma, Arkansas, Tennessee, and Kentucky. Mortality due to unclassified symptoms, signs, and abnormal findings was highest in Oklahoma, West Virginia and North Carolina.\n\n\nShow code\n# https://api.census.gov/data/key_signup.html\n# census_api_key(\"14ff972ad235695086e726484ed8f894d6d96212\", install = TRUE)\n\ndf_2021 &lt;- left_join(df_year %&gt;%\n                       select(State, matches(\"2021\")) %&gt;%\n                       rename_with(~ gsub(\" 20(1[4-9]|2[0-3])$\", \"\", .x)), \n                     df_pop %&gt;% select(State, `Population 2021`),\n                     by = \"State\") %&gt;% \n  transmute(state = State,\n            Population = `Population 2021`,\n            across(\n              all_of(disease_order),\n              ~ as.numeric(gsub(\",\", \"\", .x)), \n              .names = \"{col}\"), \n            across(\n              all_of(disease_order),\n              ~ .x / as.numeric(Population), \n              .names = \"Weighted {col}\"))\n\ndf_2023 &lt;- left_join(df_year %&gt;%\n                       select(State, matches(\"2023\")) %&gt;%\n                       rename_with(~ gsub(\" 20(1[4-9]|2[0-3])$\", \"\", .x)), \n                     df_pop %&gt;% select(State, `Population 2023`),\n                     by = \"State\") %&gt;% \n  transmute(state = State,\n            Population = `Population 2023`,\n            across(\n              all_of(disease_order),\n              ~ as.numeric(gsub(\",\", \"\", .x)), \n              .names = \"{col}\"), \n            across(\n              all_of(disease_order),\n              ~ .x / as.numeric(Population), \n              .names = \"Weighted {col}\"))\n\np1 &lt;- plot_usmap(data = df_2021, \n                 regions = \"states\", \n                 values = \"Weighted All Cause\") + \n  scale_fill_viridis_c(option = \"C\",\n                       na.value = \"lightgrey\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  theme(legend.position = 'top') +\n  labs(fill = 'All Cause Mortality (2021)') +\n  guides(\n    fill = guide_colorbar(\n      title.position = \"top\", \n      title.hjust = 0.5,      \n      barwidth = unit(10, \"cm\"),\n      barheight = unit(0.3, \"cm\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\",\n    legend.title = element_text(size = 8, face = \"bold\"),\n    legend.text  = element_text(size = 8)\n  )\n\n\np2 &lt;- plot_usmap(data = df_2021, \n                 regions = \"states\", \n                 values = \"Weighted Chronic lower respiratory diseases\") + \n  scale_fill_viridis_c(option = \"D\",\n                       na.value = \"lightgrey\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  theme(legend.position = 'top') +\n  labs(fill = 'Chronic lower respiratory diseases (2021)') +\n  guides(\n    fill = guide_colorbar(\n      title.position = \"top\", \n      title.hjust = 0.5,      \n      barwidth = unit(10, \"cm\"),\n      barheight = unit(0.3, \"cm\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\",\n    legend.title = element_text(size = 8, face = \"bold\"),\n    legend.text  = element_text(size = 8)\n  )\n\n\np3 &lt;- plot_usmap(data = df_2021, \n                 regions = \"states\", \n                 values = \"Weighted COVID\") + \n  scale_fill_viridis_c(option = \"A\",\n                       na.value = \"lightgrey\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  theme(legend.position = 'top') +\n  labs(fill = 'COVID (2021)') +\n  guides(\n    fill = guide_colorbar(\n      title.position = \"top\", \n      title.hjust = 0.5,      \n      barwidth = unit(10, \"cm\"),\n      barheight = unit(0.3, \"cm\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\",\n    legend.title = element_text(size = 8, face = \"bold\"),\n    legend.text  = element_text(size = 8)\n  )\n\n\np4 &lt;- plot_usmap(data = df_2023, \n                 regions = \"states\", \n                 values = \"Weighted Unclassified symptoms, signs and abnormal findings\") + \n  scale_fill_viridis_c(option = \"F\",\n                       na.value = \"lightgrey\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  theme(legend.position = 'top') +\n  labs(fill = 'Unclassified symptoms, signs and abnormal findings Mortality (2023)') +\n  guides(\n    fill = guide_colorbar(\n      title.position = \"top\", \n      title.hjust = 0.5,      \n      barwidth = unit(10, \"cm\"),\n      barheight = unit(0.3, \"cm\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\",\n    legend.title = element_text(size = 8, face = \"bold\"),\n    legend.text  = element_text(size = 8)\n  )\n\np5 &lt;- plot_usmap(data = df_2021, \n                 regions = \"states\", \n                 values = \"Weighted Diseases of heart\") + \n  scale_fill_viridis_c(option = \"E\",\n                       na.value = \"lightgrey\",\n                       guide = guide_colorbar(\n                         barwidth = unit(10, \"cm\"),  \n                         barheight = unit(0.3, \"cm\") \n                         )) +\n  theme(legend.position = 'top') +\n  labs(fill = 'Diseases of heart (2021)') +\n  guides(\n    fill = guide_colorbar(\n      title.position = \"top\", \n      title.hjust = 0.5,      \n      barwidth = unit(10, \"cm\"),\n      barheight = unit(0.3, \"cm\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\",\n    legend.title = element_text(size = 8, face = \"bold\"),\n    legend.text  = element_text(size = 8)\n  )\n\ntop &lt;- plot_grid(\n  p1,\n  labels = c(\"A.\"),\n  label_size = 8, \n  ncol = 1, align = \"hv\")\n\nbottom &lt;- plot_grid(\n  p2,\n  p3,\n  p4,\n  p5,\n  labels = c(\"B.\", \"C.\", \n             \"D.\", \"E\"),\n  label_size = 8, \n  ncol = 2, align = \"hv\")\n\nplot_grid(\n  top,\n  bottom,\n  ncol = 1,\n  align = \"v\",\n  rel_heights = c(1, 2)\n)\n\nrm(df_2021, df_2023, p1, p2, p3, p4, p5, top, bottom)"
  },
  {
    "objectID": "midterm.html#conclusion",
    "href": "midterm.html#conclusion",
    "title": "Analysis of the United States",
    "section": "",
    "text": "Here, I examined mortality trends in the United States between 2014-2023 across multiple causes of death, in terms of geographical and temporal patterns. Overall, mortality for most diseases increased during the COVID-19 period. Mortality from unclassified symptoms, signs, and abnorfmal findings increased sharply in 2023. There is clear seasonal patterns, with mortality lowest in summer and peak in winter. The winter of 2020-2021 showed peaks of the COVID-19 pandemic impact. Geographically, there is disproportionately high mortality in southeastern United States, particularly West Virginia, Alabama, Mississippi, across multiple causes of deaths."
  },
  {
    "objectID": "midterm.html#limitation",
    "href": "midterm.html#limitation",
    "title": "Analysis of the United States",
    "section": "",
    "text": "(1) Lack of individual level data. Unable to investigate how COVID affect different age groups, race, sex, SES, etc. (2) Lack of analysis on flags for other diseases/complications. (3) Limited reporting in 2023."
  },
  {
    "objectID": "midterm.html#disclosure-of-ai-usage",
    "href": "midterm.html#disclosure-of-ai-usage",
    "title": "Analysis of the United States",
    "section": "",
    "text": "I used ChatGPT to (1) Revise regular expression, highlight what’s wrong and why it won’t work, (2) Find a simpler way to do mutate and then select (ChatGPT: transmute), (3) Set column width in kable (ChatGPT: column_spec(1, width = \"10cm\")), (4) Find simpler way to mutate parameters across multiple columns rather than running mutate for a million times (ChatGPT: across(all_of(disease_order), ~ as.numeric(gsub(\",\", \"\", .x)), .names = \"{col}\")), (5) Search how to change text alignment and add caption in qmd, (6) check grammar."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Home",
    "section": "",
    "text": "This project serves as a continuation of my midterm project, which investigates geotemporal mortality patterns in the United States before (2014-2019) and during COVID-19 (2020-2023) pandemic.\nHere, I extend the analysis to worldwide using the mortality data from the WHO to evaluate global geotemporal mortality patterns. Detailed data processing pipeline can be found here."
  }
]